
R version 4.4.2 (2024-10-31) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("tram")
Loading required package: mlt
Loading required package: basefun
Loading required package: variables
Loading required package: mvtnorm
> require("lme4")
Loading required package: lme4
Loading required package: Matrix
> options(digits = 3)
> 
> ## ----mtram-sleep_lmer, cache = FALSE------------------------------------------
> sleep_lmer <- lmer(Reaction ~ Days + (Days | Subject), 
+                    data = sleepstudy, REML = FALSE)
> 
> 
> ## ----mtram-sleep_mtram, cache = FALSE-----------------------------------------
> sleep_LM <- Lm(Reaction ~ Days, data = sleepstudy)
> sleep_LMmer <- mtram(sleep_LM, ~ (Days | Subject), data = sleepstudy)
> 
> 
> ## ----mtram-sleep_cmp----------------------------------------------------------
> logLik(sleep_lmer)
'log Lik.' -876 (df=6)
> logLik(sleep_LMmer)
'log Lik.' -876 (df=6)
> 
> 
> ## ----mtram-sleep_sd-----------------------------------------------------------
> (sdinv <- 1 / summary(sleep_lmer)$sigma)
[1] 0.0391
> coef(sleep_LMmer)["Reaction"]
Reaction 
  0.0391 
> 
> 
> ## ----mtram-sleep_beta---------------------------------------------------------
> fixef(sleep_lmer) * c(-1, 1) * sdinv
(Intercept)        Days 
     -9.824       0.409 
> coef(sleep_LMmer)[c("(Intercept)", "Days")]
(Intercept)        Days 
     -9.824       0.409 
> 
> 
> ## ----mtram-sleep_varparm------------------------------------------------------
> sleep_lmer@theta
[1] 0.9292 0.0182 0.2226
> coef(sleep_LMmer)[-(1:3)]
gamma1 gamma2 gamma3 
0.9290 0.0184 0.2228 
> 
> 
> ## ----mtram-sleep_varcorr------------------------------------------------------
> sleep_LMmer$G * (1 / sdinv)^2
2 x 2 sparse Matrix of class "dsCMatrix"
               
[1,] 565.3 11.2
[2,]  11.2 32.7
> cov2cor(sleep_LMmer$G * (1 / sdinv)^2)
2 x 2 sparse Matrix of class "dsCMatrix"
                  
[1,] 1.0000 0.0824
[2,] 0.0824 1.0000
> unclass(VarCorr(sleep_lmer))$Subject
            (Intercept) Days
(Intercept)       565.5 11.1
Days               11.1 32.7
attr(,"stddev")
(Intercept)        Days 
      23.78        5.72 
attr(,"correlation")
            (Intercept)   Days
(Intercept)      1.0000 0.0813
Days             0.0813 1.0000
> 
> 
> ## ----mtram-sleep-Surv---------------------------------------------------------
> library("survival")
> sleepstudy$Reaction_I <- with(sleepstudy, Surv(Reaction - 20, Reaction + 20, 
+                                                type = "interval2"))
> sleepstudy$Reaction_I[1:5]
[1] [230, 270] [239, 279] [231, 271] [301, 341] [337, 377]
> 
> 
> ## ----mtram-sleep-interval, cache = FALSE--------------------------------------
> sleep_LM_I <- Lm(Reaction_I ~ Days, data = sleepstudy)
> sleep_LMmer_I <- mtram(sleep_LM_I, ~ (Days | Subject), data = sleepstudy)
> 
> 
> ## ----mtram-sleep-interval-results---------------------------------------------
> logLik(sleep_LMmer_I)
'log Lik.' -213 (df=6)
> coef(sleep_LMmer_I)
(Intercept)  Reaction_I        Days      gamma1      gamma2      gamma3 
   -10.5510      0.0422      0.4256      1.0217      0.0520      0.2234 
> coef(sleep_LMmer)
(Intercept)    Reaction        Days      gamma1      gamma2      gamma3 
    -9.8244      0.0391      0.4089      0.9290      0.0184      0.2228 
> 
> proc.time()
   user  system elapsed 
   4.65    0.08    4.73 
