
R version 4.4.1 (2024-06-14) -- "Race for Your Life"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("tram")
Loading required package: mlt
Loading required package: basefun
Loading required package: variables
Loading required package: mvtnorm
> require("lme4")
Loading required package: lme4
Loading required package: Matrix
> 
> ## ----mtram-sleep_lmer, cache = FALSE------------------------------------------
> sleep_lmer <- lmer(Reaction ~ Days + (Days | Subject), 
+                    data = sleepstudy, REML = FALSE)
> 
> 
> ## ----mtram-sleep_mtram, cache = FALSE-----------------------------------------
> sleep_LM <- Lm(Reaction ~ Days, data = sleepstudy)
> sleep_LMmer <- mtram(sleep_LM, ~ (Days | Subject), data = sleepstudy)
> 
> 
> ## ----mtram-sleep_cmp----------------------------------------------------------
> logLik(sleep_lmer)
'log Lik.' -875.9697 (df=6)
> logLik(sleep_LMmer)
'log Lik.' -875.9697 (df=6)
> 
> 
> ## ----mtram-sleep_sd-----------------------------------------------------------
> (sdinv <- 1 / summary(sleep_lmer)$sigma)
[1] 0.03907485
> coef(sleep_LMmer)["Reaction"]
  Reaction 
0.03907741 
> 
> 
> ## ----mtram-sleep_beta---------------------------------------------------------
> fixef(sleep_lmer) * c(-1, 1) * sdinv
(Intercept)        Days 
 -9.8236175   0.4090077 
> coef(sleep_LMmer)[c("(Intercept)", "Days")]
(Intercept)        Days 
 -9.8243917   0.4089265 
> 
> 
> ## ----mtram-sleep_varparm------------------------------------------------------
> sleep_lmer@theta
[1] 0.92919061 0.01816575 0.22264321
> coef(sleep_LMmer)[-(1:3)]
    gamma1     gamma2     gamma3 
0.92901066 0.01843056 0.22280431 
> 
> 
> ## ----mtram-sleep_varcorr------------------------------------------------------
> sleep_LMmer$G * (1 / sdinv)^2
2 x 2 sparse Matrix of class "dsCMatrix"
                      
[1,] 565.2580 11.21410
[2,]  11.2141 32.73513
> cov2cor(sleep_LMmer$G * (1 / sdinv)^2)
2 x 2 sparse Matrix of class "dsCMatrix"
                          
[1,] 1.00000000 0.08243925
[2,] 0.08243925 1.00000000
> unclass(VarCorr(sleep_lmer))$Subject
            (Intercept)     Days
(Intercept)   565.47697 11.05512
Days           11.05512 32.68179
attr(,"stddev")
(Intercept)        Days 
  23.779760    5.716799 
attr(,"correlation")
            (Intercept)       Days
(Intercept)  1.00000000 0.08132109
Days         0.08132109 1.00000000
> 
> 
> ## ----mtram-sleep-Surv---------------------------------------------------------
> library("survival")
> sleepstudy$Reaction_I <- with(sleepstudy, Surv(Reaction - 20, Reaction + 20, 
+                                                type = "interval2"))
> sleepstudy$Reaction_I[1:5]
[1] [229.5600, 269.5600] [238.7047, 278.7047] [230.8006, 270.8006]
[4] [301.4398, 341.4398] [336.8519, 376.8519]
> 
> 
> ## ----mtram-sleep-interval, cache = FALSE--------------------------------------
> sleep_LM_I <- Lm(Reaction_I ~ Days, data = sleepstudy)
> sleep_LMmer_I <- mtram(sleep_LM_I, ~ (Days | Subject), data = sleepstudy)
> 
> 
> ## ----mtram-sleep-interval-results---------------------------------------------
> logLik(sleep_LMmer_I)
'log Lik.' -213.3648 (df=6)
> coef(sleep_LMmer_I)
 (Intercept)   Reaction_I         Days       gamma1       gamma2       gamma3 
-10.55102439   0.04217345   0.42564321   1.02172120   0.05196121   0.22344583 
> coef(sleep_LMmer)
(Intercept)    Reaction        Days      gamma1      gamma2      gamma3 
-9.82439168  0.03907741  0.40892652  0.92901066  0.01843056  0.22280431 
> 
> proc.time()
   user  system elapsed 
  4.641   0.063   4.700 
