<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Transformation Models</title>

    <link rel="stylesheet" type="text/css" href="http://ctm.r-forge.r-project.org/assets/css/styles_feeling_responsive.css">

  

	<script src="http://ctm.r-forge.r-project.org/assets/js/modernizr.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
	<script>
		WebFont.load({
			google: {
				families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ]
			}
		});
	</script>

	<noscript>
		<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7CVolkhov' rel='stylesheet' type='text/css'>
	</noscript>


	<!-- Search Engine Optimization -->
	<meta name="description" content="Research and Software for Transformation Models">
	<meta name="google-site-verification" content="">
	
	
	<link rel="author" href="">
	
	
	<link rel="canonical" href="http://ctm.r-forge.r-project.org/software/">


	<!-- Facebook Open Graph -->
    <meta property="og:title" content="Transformation Models">
	<meta property="og:description" content="Research and Software for Transformation Models">
	<meta property="og:url" content="http://ctm.r-forge.r-project.org/software/">
	<meta property="og:locale" content="en_EN">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="Transformation Models">
	
	


	

	<link type="text/plain" rel="author" href="http://ctm.r-forge.r-project.org/humans.txt">

	

	


	

</head>
<body id="top-of-page" class="post">
	
	
<div id="navigation" class="sticky">
  <nav class="top-bar" role="navigation" data-topbar>
    <ul class="title-area">
      <li class="name">
      <h1 class="show-for-small-only"><a href="http://ctm.r-forge.r-project.org" class="icon-tree"> Transformation Models</a></h1>
    </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span>Nav</span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
        

              

          
          
            
            
              <li class="divider"></li>
              <li><a  href="http://ctm.r-forge.r-project.org/people/">People</a></li>

            
            
          
        
        
      </ul>

      <ul class="left">
        

              

          
          

            
            
              <li><a  href="http://ctm.r-forge.r-project.org/">Start</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://ctm.r-forge.r-project.org/research/">Research</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li class="active"><a  href="http://ctm.r-forge.r-project.org/software/">Software</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          

            
            
              <li><a  href="http://ctm.r-forge.r-project.org/news/">News</a></li>
              <li class="divider"></li>

            
            
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->

	

	

<div id="masthead-no-image-header">
	<div class="row">
		<div class="small-12 columns">
			<a id="logo" href="http://ctm.r-forge.r-project.org/" title="Transformation Models – Research and Software for Transformation Models">
				<img src="http://ctm.r-forge.r-project.org/assets/img/logo.png" alt="Transformation Models – Research and Software for Transformation Models">
			</a>
		</div><!-- /.small-12.columns -->
	</div><!-- /.row -->
</div><!-- /#masthead -->








	<div class="row t30">
	<div class="medium-8 columns medium-offset-2 end">
		<article itemscope itemtype="http://schema.org/Article">
			<header>
				

				<div itemprop="name">
					
					<h1></h1>
				</div>
			</header>


			

			<div itemprop="articleSection">
			<h1 id="a-simple-transformation-model">A Simple Transformation Model</h1>

<p>First, install and fire-up R on your computer. Within R, one needs to
install the tram package by typing</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s2">"tram"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>and hitting the ENTER key. The tram package implements simple formula-based
interfaces to some important transformation models. The models themself are
fitted using algorithms implemented in <a href="https://CRAN.R-project.org/package=mlt">mlt add-on
package</a>.</p>

<p>Once the package is installed, you can load it using</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"tram"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Loading required package: mlt
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Loading required package: basefun
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Loading required package: variables
</code></pre></div></div>

<p>Now all tram functions are ready to be used, for example the Colr()
function for fitting a series of potentially stratified logistic regression
models to a continuous outcome variable (let’s start with median 
Boston Housing values):</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">(</span><span class="s2">"BostonHousing2"</span><span class="p">,</span><span class="w"> </span><span class="n">package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"mlbench"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s2">"survival"</span><span class="p">)</span><span class="w">
</span><span class="n">BostonHousing2</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">with</span><span class="p">(</span><span class="n">BostonHousing2</span><span class="p">,</span><span class="w"> </span><span class="n">Surv</span><span class="p">(</span><span class="n">cmedv</span><span class="p">,</span><span class="w"> </span><span class="n">cmedv</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">50</span><span class="p">))</span><span class="w">
</span><span class="n">Colr_BH_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Colr</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chas</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">crim</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">indus</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nox</span><span class="w"> </span><span class="o">+</span><span class="w"> 
                  </span><span class="n">rm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dis</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ptratio</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lstat</span><span class="p">,</span><span class="w"> 
                  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BostonHousing2</span><span class="p">,</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">Colr_BH_1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
##   Continuous Outcome Logistic Regression 
## 
## Call:
## Colr(formula = y | 0 + chas ~ crim + zn + indus + nox + rm + 
##     age + dis + rad + tax + ptratio + b + lstat, data = BostonHousing2, 
##     support = c(10, 50))
## 
## Coefficients:
##          Estimate Std. Error z value Pr(&gt;|z|)    
## crim     0.082648   0.013712   6.028 1.66e-09 ***
## zn      -0.010274   0.004923  -2.087   0.0369 *  
## indus   -0.025228   0.021448  -1.176   0.2395    
## nox      7.073148   1.491789   4.741 2.12e-06 ***
## rm      -1.534726   0.218966  -7.009 2.40e-12 ***
## age      0.008430   0.005118   1.647   0.0996 .  
## dis      0.496611   0.077792   6.384 1.73e-10 ***
## rad     -0.120764   0.024925  -4.845 1.27e-06 ***
## tax      0.006483   0.001334   4.861 1.17e-06 ***
## ptratio  0.395724   0.048314   8.191 2.22e-16 ***
## b       -0.006452   0.001112  -5.803 6.50e-09 ***
## lstat    0.281480   0.026504  10.620  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Log-Likelihood:
##  -1297.489 (df = 26)
## Likelihood-ratio Test: Chisq = 879.7637 on 12 degrees of freedom; p = &lt; 2.2e-16
</code></pre></div></div>
<p>Two separate transformation function are fitted (for houses near and off
Charles river, variable chas). The remaining variables enter a linear
predictor those coefficients can be interpreted as log-odds ratios. Note
that median housing values larger than 50 are correctly treated as being 
right-censored in the likelihood-</p>

<p>The model can be used to extract the corresponding 
conditional distribution functions. Let’s put the first house into two
locations, near and off Charles river. Then, we compute the two conditional
distribution functions:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">BostonHousing2</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),]</span><span class="w">
</span><span class="n">nd</span><span class="o">$</span><span class="n">chas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">BostonHousing2</span><span class="o">$</span><span class="n">chas</span><span class="p">))</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s2">"colorspace"</span><span class="p">)</span><span class="w">
</span><span class="n">col</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diverge_hcl</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">246</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">96</span><span class="p">,</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">65</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">as.mlt</span><span class="p">(</span><span class="n">Colr_BH_1</span><span class="p">),</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nd</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"distribution"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"bottomright"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Off"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Near"</span><span class="p">),</span><span class="w"> </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Charles river"</span><span class="p">,</span><span class="w">
       </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="../images/BHplot-1.png" alt="plot of chunk BHplot" />
It appears that houses near the river are more expensive, and the
variability is also larger compared to houses far away from the river.</p>

<p>The most important feature in this model is that the shape of these
distributions have been estimated from data although the models are fully
parametric! An introduction to the underlying technology with many more
examples is available from
the <a href="https://cran.r-project.org/web/packages/mlt.docreg/vignettes/mlt.pdf">mlt.docreg package vignette</a>.</p>

			</div>

			

			
		</article>
	</div><!-- /.medium-8.columns -->


	


	
</div><!-- /.row -->


	
	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" href="#top-of-page">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->


    <footer id="footer-content" class="bg-grau">
      <div id="footer">
        <div class="row">
          <div class="medium-6 large-5 columns">
            <h5 class="shadow-black">About</h5>

            <p class="shadow-black">
              Research and Software for Transformation Models
            </p>
          </div><!-- /.large-6.columns -->


          <div class="small-6 medium-3 large-3 large-offset-1 columns">
            
              
                <h5 class="shadow-black">Services</h5>
              
            
              
            

              <ul class="no-bullet shadow-black">
              
                
                  <li >
                    <a href="http://ctm.r-forge.r-project.org"  title=""></a>
                  </li>
              
                
                  <li >
                    <a href="http://ctm.r-forge.r-project.org/contact/"  title="Contact">Contact</a>
                  </li>
              
              </ul>
          </div><!-- /.large-4.columns -->


          <div class="small-6 medium-3 large-3 columns">
            
              
                <h5 class="shadow-black">Network</h5>
              
            
              
            

            <ul class="no-bullet shadow-black">
            
              
                <li >
                  <a href="http://ctm.r-forge.r-project.org"  title=""></a>
                </li>
            
              
                <li class="" >
                  <a href="https://r-forge.r-project.org/projects/ctm/" target="_blank"  title="">Transformation Models at R-forge</a>
                </li>
            
            </ul>
          </div><!-- /.large-3.columns -->
        </div><!-- /.row -->

      </div><!-- /#footer -->


      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-12 medium-6 columns credits">
            <p>Built with <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> based on <a href="http://phlow.github.io/feeling-responsive/">Feeling Responsive</a> by <a href="http://phlow.de/">Phlow</a>.</p>
          </section>

          <section id="subfooter-right" class="small-12 medium-6 columns">
            <ul class="inline-list social-icons">
            
            </ul>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>

	

	


<script src="http://ctm.r-forge.r-project.org/assets/js/javascript.min.js"></script>














</body>
</html>

