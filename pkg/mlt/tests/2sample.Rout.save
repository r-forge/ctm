
R version 3.1.2 (2014-10-31) -- "Pumpkin Helmet"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("mlt")
Loading required package: basefun
Loading required package: Matrix
Loading required package: polynom
Loading required package: numDeriv
> 
> set.seed(28)
> n <- 100
> g <- gl(2, n)
> y <- rnorm(length(g), mean = c(2, 1)[g], sd = c(.5, 1.5)[g])
> mydata <- data.frame(g = g, y = y)
> 
> by <- polynomial_basis(c(1, 1), var = "y", support = range(y), ci = c(-Inf, 0))
> bg1 <- as.basis(~ g - 1)
> 
> m1 <- model(by, inter = bg1, remove_intercept = TRUE)
> fm1 <- mlt(m1, data = mydata)
Note: method with signature 'diagonalMatrix#Matrix' chosen for function 'kronecker',
 target signature 'ddiMatrix#ddiMatrix'.
 "Matrix#diagonalMatrix" would also be valid
Note: method with signature 'TsparseMatrix#sparseMatrix' chosen for function 'kronecker',
 target signature 'dtTMatrix#ddiMatrix'.
 "Matrix#diagonalMatrix" would also be valid
Note: method with signature 'Matrix#numLike' chosen for function '%*%',
 target signature 'dgTMatrix#numeric'.
 "TsparseMatrix#ANY" would also be valid
Note: method with signature 'Matrix#matrix' chosen for function '%*%',
 target signature 'dgTMatrix#matrix'.
 "TsparseMatrix#ANY" would also be valid
iter:  0  f-value:  341.6287  pgrad:  49.32291 
iter:  10  f-value:  266.1316  pgrad:  11.3708 
iter:  20  f-value:  259.79  pgrad:  1.594479 
iter:  30  f-value:  259.6653  pgrad:  7.089959 
iter:  40  f-value:  259.6152  pgrad:  0.004269509 
iter:  0  f-value:  259.6152  pgrad:  0.0001606293 
Score: 1.000031  Hessian: 2.029424e-09 
Warning message:
In mlt(m1, data = mydata) : NB not met
> logLik(fm1)
'log Lik.' -259.6152 (df=4)
> vcov(fm1)
            1           2           1           2
1  0.08823069 -0.03935623  0.00000000  0.00000000
2 -0.03935623  0.01979929  0.00000000  0.00000000
1  0.00000000  0.00000000  0.01091145 -0.00136613
2  0.00000000  0.00000000 -0.00136613  0.00204762
> cf1 <- coef(fm1)
> 1 / cf1[c(2, 4)] 
        2         2 
0.5025284 1.5626450 
> -cf1[c(1, 3)] / cf1[c(2,4)]
        1         1 
1.9877585 0.6671793 
> 
> ### no constraints here!
> by2 <- polynomial_basis(c(1, 1), var = "y", support = range(y))
> bg2 <- as.basis(~ g, remove_intercept = TRUE)
> m2 <- model(by, inter = b(b1 = by2, b2 = bg2))
> fm2 <- mlt(m2, data = mydata)
Note: method with signature 'Matrix#numLike' chosen for function '%*%',
 target signature 'dtTMatrix#numeric'.
 "TsparseMatrix#ANY" would also be valid
Note: method with signature 'Matrix#matrix' chosen for function '%*%',
 target signature 'dtTMatrix#matrix'.
 "TsparseMatrix#ANY" would also be valid
iter:  0  f-value:  341.6287  pgrad:  49.3229 
iter:  10  f-value:  299.8039  pgrad:  16.73724 
iter:  20  f-value:  274.6782  pgrad:  9.073611 
iter:  30  f-value:  267.2569  pgrad:  12.60349 
iter:  40  f-value:  262.6291  pgrad:  5.200912 
iter:  50  f-value:  261.2799  pgrad:  3.352224 
iter:  60  f-value:  260.6238  pgrad:  15.90531 
iter:  70  f-value:  260.0913  pgrad:  12.68358 
iter:  80  f-value:  259.7971  pgrad:  2.339358 
iter:  90  f-value:  259.68  pgrad:  0.5323511 
iter:  100  f-value:  259.6285  pgrad:  0.3502112 
iter:  110  f-value:  259.6208  pgrad:  0.1527241 
iter:  120  f-value:  259.617  pgrad:  0.4315666 
iter:  130  f-value:  259.6162  pgrad:  0.1102728 
iter:  140  f-value:  259.6157  pgrad:  0.04888818 
iter:  150  f-value:  259.6152  pgrad:  0.04811 
iter:  160  f-value:  259.6152  pgrad:  0.0135725 
iter:  170  f-value:  259.6152  pgrad:  0.0001801936 
iter:  0  f-value:  259.6152  pgrad:  0.0001852588 
Score: 1.000004  Hessian: 0.0001899816 
Warning messages:
1: In mlt(m2, data = mydata) : NB not met
2: In .log(mmprime %*% beta) :
  negative contribution to likelihood; model constraints violated!
> logLik(fm2)
'log Lik.' -259.6152 (df=4)
> vcov(fm2)
            1           2           1           2
1  0.08823033 -0.03935604 -0.08823033  0.03935604
2 -0.03935604  0.01979920  0.03935604 -0.01979920
1 -0.08823033  0.03935604  0.09914178 -0.04072217
2  0.03935604 -0.01979920 -0.04072217  0.02184682
> (cf2 <- coef(fm2))
        1         2         1         2 
-3.955495  1.989928  3.528538 -1.349987 
> c(cf1[1:2], cf1[3:4] - cf1[1:2])
        1         2         1         2 
-3.955515  1.989937  3.528560 -1.349997 
> 
> 1 / cf2[2]
        2 
0.5025308 
> 1 / sum(cf2[c(2, 4)])
[1] 1.562644
> 
> -cf2[1] / cf2[2]
       1 
1.987758 
> -sum(cf2[c(1, 3)]) / sum(cf2[c(2, 4)])
[1] 0.6671814
> 
> proc.time()
   user  system elapsed 
  2.398   0.058   2.454 
