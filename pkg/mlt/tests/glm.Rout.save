
R version 3.2.1 (2015-06-18) -- "World-Famous Astronaut"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("mlt")
Loading required package: basefun
> set.seed(29)
> 
> n <- 100
> p <- 2
> x <- matrix(runif(n * p), nrow = n)
> beta <- c(1, -1)
> y <- factor(rbinom(n, size = 1, prob = plogis(x %*% beta)))
> df <- data.frame(y = y, x)
> 
> m1 <- glm(y ~ X1 + X2, data = df, family = binomial())
> coef(m1)
(Intercept)          X1          X2 
  0.7372381  -0.3848546  -0.8292045 
> 
> m <- model(~ y, shift = ~ X1 + X2, todist = "Logis")
> m2 <- mlt(m, data = df, fixed = c("y.L" = 0))
Gradient[1] "Mean relative difference: 0.0001754592"
Hessian:[1] TRUE
Warning message:
In R(exact = y) : response is unordered factor; 
                         results may depend on order of levels
> coef(m2)
(Intercept)         y.L          X1          X2 
 -0.7372349   0.0000000   0.3848510   0.8292017 
> 
> max(abs(coef(m1) + coef(m2)[-2]))
[1] 3.580145e-06
> 
> logLik(m1)
'log Lik.' -68.12815 (df=3)
> logLik(m2)
'log Lik.' -68.12815 (df=3)
> 
> library("nnet")
> 
> m1 <- multinom(Species ~ ., data = iris)
# weights:  18 (10 variable)
initial  value 164.791843 
iter  10 value 16.177348
iter  20 value 7.111438
iter  30 value 6.182999
iter  40 value 5.984028
iter  50 value 5.961278
iter  60 value 5.954900
iter  70 value 5.951851
iter  80 value 5.950343
iter  90 value 5.949904
iter 100 value 5.949867
final  value 5.949867 
stopped after 100 iterations
> coef(m1)
           (Intercept) Sepal.Length Sepal.Width Petal.Length Petal.Width
versicolor    18.69037    -5.458424   -8.707401     14.24477   -3.097684
virginica    -23.83628    -7.923634  -15.370769     23.65978   15.135301
> 
> oiris <- iris
> oiris$Species <- ordered(oiris$Species)
> 
> r <- as.basis(~ Species, data = oiris, remove_intercept = TRUE,
+               contrasts.arg = list(Species = function(n)
+                   contr.treatment(n, base = 3)),
+               ui = diff(diag(2)), ci = rep(0, 1))
> 
> m <- model(r, interacting = as.basis(~ Sepal.Length + Sepal.Width + Petal.Length + Petal.Width, data = oiris),
+            todistr = "Logis")
> m2 <- mlt(m, data = oiris)
Gradient[1] "Mean relative difference: 4.482669e-07"
Hessian:[1] "Mean relative difference: 0.0004797972"
Warning messages:
1: In .log(.dealinf(mmr, beta, offset, d$p, 1) - .dealinf(mml, beta,  :
  negative contribution to likelihood; constraints violated!
2: In .log(.dealinf(mmr, beta, offset, d$p, 1) - .dealinf(mml, beta,  :
  negative contribution to likelihood; constraints violated!
3: In spg(par = theta, fn = loglikfct, gr = scorefct, project = "projectLinear",  :
  Unsuccessful convergence.
> coef(m2)
 Species1:(Intercept)  Species2:(Intercept) Species1:Sepal.Length 
            0.5334547            42.6378008             2.3599572 
Species2:Sepal.Length  Species1:Sepal.Width  Species2:Sepal.Width 
            2.4652423             6.2037428             6.6808441 
Species1:Petal.Length Species2:Petal.Length  Species1:Petal.Width 
          -10.6655199            -9.4293797            -5.2953701 
 Species2:Petal.Width 
          -18.2861593 
> 
> s <- sort(unique(oiris$Species))
> 
> pp2 <- predict(m2, newdata = oiris, q = s, type = "density")
> 
> pp1 <- predict(m1, newdata = iris, type = "prob")
> 
> max(abs(pp1 - t(pp2)))
[1] 0.001181005
> 
> 
> proc.time()
   user  system elapsed 
  2.584   0.014   2.592 
