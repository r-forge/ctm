
R version 3.1.2 (2014-10-31) -- "Pumpkin Helmet"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("mlt")
Loading required package: basefun
Loading required package: Matrix
Loading required package: polynom
Loading required package: numDeriv
> 
> set.seed(29)
> n <- 1000	
> y <- rnorm(n, 2, 1.5)
> d <- data.frame(y = y)
> 
> lin <- polynomial_basis(c(1, 1), var = "y", support = range(y), ci = c(-Inf, 0))
> m <- model(lin)
> 
> o <- mlt(m, data = d)
iter:  0  f-value:  1892.923  pgrad:  1.606738 
iter:  0  f-value:  1892.922  pgrad:  0.0005349915 
Score: 1.000004  Hessian: 6.696155e-10 
Warning message:
In mlt(m, data = d) : NB not met
> 
> s2ml <- sqrt(var(y) * (n - 1) / n)
> 1 / coef(o)[2] - s2ml
           2 
2.880147e-07 
> 
> -coef(o)[1] / coef(o)[2] - mean(y)
           1 
-7.93969e-07 
> 
> x <- runif(n, max = 2 * pi)
> y <- rnorm(n, sin(x), .25)
> d <- data.frame(y = y, x = x)
> 
> plot(x, y)
> 
> Bb <- Bernstein_basis(order = 10, support = c(0, 2*pi), var = "x", ui = "zero")
> m <- model(lin, shift = Bb)
> 
> o <- mlt(m, data = d)
iter:  0  f-value:  1140.721  pgrad:  140.5022 
iter:  10  f-value:  448.486  pgrad:  44.50584 
iter:  20  f-value:  213.4659  pgrad:  23.09385 
iter:  30  f-value:  123.772  pgrad:  162.1536 
iter:  40  f-value:  92.66658  pgrad:  7.391999 
iter:  50  f-value:  78.73565  pgrad:  13.57501 
iter:  60  f-value:  77.21995  pgrad:  2.339021 
iter:  70  f-value:  76.90053  pgrad:  1.809245 
iter:  80  f-value:  76.7622  pgrad:  7.547281 
iter:  90  f-value:  76.40952  pgrad:  0.6036662 
iter:  100  f-value:  76.10059  pgrad:  0.4383519 
iter:  110  f-value:  76.06598  pgrad:  1.346079 
iter:  120  f-value:  75.99712  pgrad:  1.436956 
iter:  130  f-value:  75.98447  pgrad:  0.2317076 
iter:  140  f-value:  75.94242  pgrad:  0.9928991 
iter:  150  f-value:  75.92669  pgrad:  0.1567065 
iter:  160  f-value:  75.92096  pgrad:  0.2117287 
iter:  170  f-value:  75.91874  pgrad:  1.039323 
iter:  180  f-value:  75.89863  pgrad:  3.488666 
iter:  190  f-value:  75.88446  pgrad:  0.1057774 
iter:  200  f-value:  75.87641  pgrad:  0.6775554 
iter:  0  f-value:  75.87603  pgrad:  0.1178597 
iter:  10  f-value:  75.87224  pgrad:  0.4088927 
iter:  20  f-value:  75.86946  pgrad:  0.105016 
iter:  30  f-value:  75.86838  pgrad:  0.09454696 
iter:  40  f-value:  75.85336  pgrad:  0.07961987 
iter:  50  f-value:  75.85624  pgrad:  1.404919 
iter:  60  f-value:  75.85013  pgrad:  0.08431002 
iter:  70  f-value:  75.84651  pgrad:  0.07932298 
iter:  80  f-value:  75.84224  pgrad:  1.33897 
iter:  90  f-value:  75.83948  pgrad:  0.4820283 
iter:  100  f-value:  75.83832  pgrad:  0.8684819 
iter:  110  f-value:  75.83712  pgrad:  0.07461999 
iter:  120  f-value:  75.83243  pgrad:  0.0737208 
iter:  130  f-value:  75.83175  pgrad:  0.1067873 
iter:  140  f-value:  75.82898  pgrad:  0.6469961 
iter:  150  f-value:  75.82542  pgrad:  0.07186241 
iter:  160  f-value:  75.82378  pgrad:  0.07854207 
iter:  170  f-value:  75.82345  pgrad:  0.06781439 
iter:  180  f-value:  75.82289  pgrad:  0.0677981 
iter:  190  f-value:  75.78804  pgrad:  0.06490333 
iter:  200  f-value:  75.77788  pgrad:  0.06793699 
iter:  210  f-value:  75.77726  pgrad:  0.0629949 
iter:  220  f-value:  75.77698  pgrad:  0.06325159 
iter:  230  f-value:  75.77375  pgrad:  0.06280012 
iter:  240  f-value:  75.75767  pgrad:  0.0526479 
iter:  250  f-value:  75.75702  pgrad:  0.1426026 
iter:  260  f-value:  75.75563  pgrad:  0.06275187 
iter:  270  f-value:  75.75498  pgrad:  0.06069306 
iter:  280  f-value:  75.75258  pgrad:  0.1325324 
iter:  290  f-value:  75.75205  pgrad:  0.05860799 
iter:  300  f-value:  75.751  pgrad:  0.06092631 
iter:  310  f-value:  75.75054  pgrad:  0.093086 
iter:  320  f-value:  75.74901  pgrad:  0.5148629 
iter:  330  f-value:  75.74788  pgrad:  0.05635848 
iter:  340  f-value:  75.74739  pgrad:  0.08476777 
iter:  350  f-value:  75.74368  pgrad:  5.709064 
iter:  360  f-value:  75.72148  pgrad:  0.0528213 
iter:  370  f-value:  75.72099  pgrad:  0.0549583 
iter:  380  f-value:  75.71946  pgrad:  0.2690538 
iter:  390  f-value:  75.71848  pgrad:  0.1451283 
iter:  400  f-value:  75.71781  pgrad:  0.0614819 
iter:  410  f-value:  75.71701  pgrad:  0.1062863 
iter:  420  f-value:  75.71671  pgrad:  0.2457972 
iter:  430  f-value:  75.71576  pgrad:  0.05474128 
iter:  440  f-value:  75.71497  pgrad:  0.2595039 
iter:  450  f-value:  75.71447  pgrad:  0.05123979 
iter:  460  f-value:  75.71372  pgrad:  0.05269867 
iter:  470  f-value:  75.71266  pgrad:  0.8211119 
iter:  480  f-value:  75.71196  pgrad:  0.358996 
iter:  490  f-value:  75.71108  pgrad:  0.05321945 
iter:  500  f-value:  75.71038  pgrad:  0.05433699 
iter:  510  f-value:  75.70934  pgrad:  0.0533853 
iter:  520  f-value:  75.7086  pgrad:  0.0532592 
iter:  530  f-value:  75.70516  pgrad:  0.8077999 
iter:  540  f-value:  75.70449  pgrad:  0.1195208 
iter:  550  f-value:  75.70334  pgrad:  0.3040344 
iter:  560  f-value:  75.70287  pgrad:  0.0475506 
iter:  570  f-value:  75.70243  pgrad:  0.0526226 
iter:  580  f-value:  75.70215  pgrad:  0.05243183 
iter:  590  f-value:  75.68487  pgrad:  0.04968148 
iter:  600  f-value:  75.68238  pgrad:  0.3256119 
iter:  610  f-value:  75.68117  pgrad:  0.04501094 
iter:  620  f-value:  75.68073  pgrad:  0.04946251 
iter:  630  f-value:  75.6774  pgrad:  0.09388132 
iter:  640  f-value:  75.67686  pgrad:  0.04544686 
iter:  650  f-value:  75.67596  pgrad:  0.04888044 
iter:  660  f-value:  75.67567  pgrad:  0.04878287 
iter:  670  f-value:  75.67527  pgrad:  0.04880491 
iter:  680  f-value:  75.65152  pgrad:  0.05355472 
iter:  690  f-value:  75.65093  pgrad:  0.08068124 
iter:  700  f-value:  75.64895  pgrad:  0.04136522 
iter:  710  f-value:  75.64836  pgrad:  0.6899968 
iter:  720  f-value:  75.64765  pgrad:  0.05639197 
iter:  730  f-value:  75.6471  pgrad:  0.06151295 
iter:  740  f-value:  75.64661  pgrad:  0.06325932 
iter:  750  f-value:  75.64625  pgrad:  1.358737 
iter:  760  f-value:  75.64472  pgrad:  0.1506958 
iter:  770  f-value:  75.64455  pgrad:  1.060862 
iter:  780  f-value:  75.64323  pgrad:  0.04903625 
iter:  790  f-value:  75.64287  pgrad:  0.162946 
iter:  800  f-value:  75.64246  pgrad:  0.06257671 
iter:  810  f-value:  75.64217  pgrad:  1.462934 
iter:  820  f-value:  75.63209  pgrad:  0.4220179 
iter:  830  f-value:  75.63173  pgrad:  0.04351568 
iter:  840  f-value:  75.63017  pgrad:  0.03646688 
iter:  850  f-value:  75.62992  pgrad:  0.08164648 
iter:  860  f-value:  75.62892  pgrad:  0.231506 
iter:  870  f-value:  75.62563  pgrad:  0.05143182 
iter:  880  f-value:  75.62526  pgrad:  0.03691478 
iter:  890  f-value:  75.62473  pgrad:  0.4475371 
iter:  900  f-value:  75.62428  pgrad:  0.04259193 
iter:  910  f-value:  75.62287  pgrad:  0.04991011 
iter:  920  f-value:  75.62256  pgrad:  0.1016442 
iter:  930  f-value:  75.62203  pgrad:  0.09205087 
iter:  940  f-value:  75.62098  pgrad:  1.359372 
iter:  950  f-value:  75.61652  pgrad:  0.05416594 
iter:  960  f-value:  75.61614  pgrad:  0.1920507 
iter:  970  f-value:  75.61529  pgrad:  0.03635605 
iter:  980  f-value:  75.61459  pgrad:  0.04165448 
iter:  990  f-value:  75.61433  pgrad:  0.04161901 
iter:  1000  f-value:  75.60269  pgrad:  0.3366386 
iter:  1010  f-value:  75.60005  pgrad:  0.06562832 
iter:  1020  f-value:  75.59985  pgrad:  0.04016413 
iter:  1030  f-value:  75.59703  pgrad:  0.03986832 
iter:  1040  f-value:  75.59655  pgrad:  0.03986242 
iter:  1050  f-value:  75.59198  pgrad:  0.06592193 
iter:  1060  f-value:  75.59183  pgrad:  0.4122525 
iter:  1070  f-value:  75.58961  pgrad:  0.8619506 
iter:  1080  f-value:  75.58873  pgrad:  0.0389264 
iter:  1090  f-value:  75.58668  pgrad:  0.5257371 
iter:  1100  f-value:  75.58606  pgrad:  0.04832219 
iter:  1110  f-value:  75.58554  pgrad:  0.0388005 
iter:  1120  f-value:  75.5822  pgrad:  0.03840323 
iter:  1130  f-value:  75.58056  pgrad:  0.0378612 
iter:  1140  f-value:  75.58011  pgrad:  0.03766015 
iter:  1150  f-value:  75.57942  pgrad:  0.03820601 
iter:  1160  f-value:  75.5783  pgrad:  0.04091247 
iter:  1170  f-value:  75.57489  pgrad:  0.8240233 
iter:  1180  f-value:  75.57277  pgrad:  0.1020279 
iter:  1190  f-value:  75.57132  pgrad:  0.1079325 
iter:  1200  f-value:  75.57075  pgrad:  0.04304474 
iter:  1210  f-value:  75.57055  pgrad:  0.1895186 
iter:  1220  f-value:  75.57003  pgrad:  0.03746438 
iter:  1230  f-value:  75.56878  pgrad:  0.0373618 
iter:  1240  f-value:  75.56885  pgrad:  0.2997531 
iter:  1250  f-value:  75.56807  pgrad:  0.03739055 
iter:  1260  f-value:  75.56774  pgrad:  0.03724724 
iter:  1270  f-value:  75.56584  pgrad:  0.03514576 
iter:  1280  f-value:  75.56479  pgrad:  0.04251325 
iter:  1290  f-value:  75.56444  pgrad:  0.3189831 
iter:  1300  f-value:  75.56411  pgrad:  0.04440972 
iter:  1310  f-value:  75.5639  pgrad:  0.03692638 
iter:  1320  f-value:  75.55828  pgrad:  0.03624279 
iter:  1330  f-value:  75.55798  pgrad:  0.06695063 
iter:  1340  f-value:  75.55783  pgrad:  0.7632874 
iter:  1350  f-value:  75.54215  pgrad:  0.03507749 
iter:  1360  f-value:  75.5415  pgrad:  0.14631 
iter:  1370  f-value:  75.54125  pgrad:  0.03702677 
iter:  1380  f-value:  75.54087  pgrad:  0.03835619 
iter:  1390  f-value:  75.54059  pgrad:  0.03495056 
iter:  1400  f-value:  75.53995  pgrad:  0.03498959 
iter:  1410  f-value:  75.52908  pgrad:  0.08100624 
iter:  1420  f-value:  75.52877  pgrad:  0.05558053 
iter:  1430  f-value:  75.52864  pgrad:  0.03407204 
iter:  1440  f-value:  75.52665  pgrad:  0.05586991 
iter:  1450  f-value:  75.52643  pgrad:  0.03394207 
iter:  1460  f-value:  75.49087  pgrad:  0.06621467 
iter:  1470  f-value:  75.4906  pgrad:  0.06955137 
iter:  1480  f-value:  75.48943  pgrad:  0.04182131 
iter:  1490  f-value:  75.48936  pgrad:  0.3610898 
iter:  1500  f-value:  75.48893  pgrad:  0.03859998 
iter:  0  f-value:  75.48893  pgrad:  0.03505896 
iter:  10  f-value:  75.48829  pgrad:  0.03238824 
iter:  20  f-value:  75.48478  pgrad:  0.03949832 
iter:  30  f-value:  75.48468  pgrad:  0.03229967 
iter:  40  f-value:  75.48112  pgrad:  0.03236729 
iter:  50  f-value:  75.47995  pgrad:  0.03206944 
iter:  60  f-value:  75.47867  pgrad:  0.0325692 
iter:  70  f-value:  75.47863  pgrad:  0.5078367 
iter:  80  f-value:  75.47169  pgrad:  2.347825 
iter:  90  f-value:  75.46647  pgrad:  0.05135223 
iter:  100  f-value:  75.46566  pgrad:  0.03188843 
iter:  110  f-value:  75.4639  pgrad:  0.04161952 
iter:  120  f-value:  75.46365  pgrad:  0.3492215 
iter:  130  f-value:  75.46292  pgrad:  0.2164981 
iter:  140  f-value:  75.46201  pgrad:  0.03232477 
iter:  150  f-value:  75.46174  pgrad:  0.03191972 
iter:  160  f-value:  75.45906  pgrad:  0.1460132 
iter:  170  f-value:  75.45874  pgrad:  0.1199782 
iter:  180  f-value:  75.45841  pgrad:  0.6783701 
iter:  190  f-value:  75.45774  pgrad:  0.03792717 
iter:  200  f-value:  75.45743  pgrad:  0.03762195 
iter:  210  f-value:  75.4573  pgrad:  0.3930112 
iter:  220  f-value:  75.45656  pgrad:  0.1070101 
iter:  230  f-value:  75.45634  pgrad:  0.03224755 
iter:  240  f-value:  75.45633  pgrad:  1.040576 
iter:  250  f-value:  75.45551  pgrad:  0.0341892 
iter:  260  f-value:  75.45537  pgrad:  0.4163787 
iter:  270  f-value:  75.45511  pgrad:  0.03193357 
iter:  280  f-value:  75.45492  pgrad:  0.03158902 
iter:  290  f-value:  75.45445  pgrad:  0.08366814 
iter:  300  f-value:  75.45273  pgrad:  0.1052579 
iter:  310  f-value:  75.45231  pgrad:  0.474905 
iter:  320  f-value:  75.451  pgrad:  1.179217 
iter:  330  f-value:  75.45001  pgrad:  0.03155289 
iter:  340  f-value:  75.44945  pgrad:  0.03195001 
iter:  350  f-value:  75.44829  pgrad:  0.03358066 
iter:  360  f-value:  75.44801  pgrad:  0.03105546 
iter:  370  f-value:  75.44731  pgrad:  1.020826 
iter:  380  f-value:  75.44641  pgrad:  0.03211691 
iter:  390  f-value:  75.44514  pgrad:  0.04013613 
iter:  400  f-value:  75.44492  pgrad:  0.3164199 
iter:  410  f-value:  75.44464  pgrad:  0.03197208 
iter:  420  f-value:  75.44407  pgrad:  0.108928 
iter:  430  f-value:  75.44377  pgrad:  0.4611239 
iter:  440  f-value:  75.44288  pgrad:  0.03393916 
iter:  450  f-value:  75.4425  pgrad:  0.04601886 
iter:  460  f-value:  75.44206  pgrad:  0.09579953 
iter:  470  f-value:  75.44189  pgrad:  0.03175802 
iter:  480  f-value:  75.44152  pgrad:  0.03780859 
iter:  490  f-value:  75.44124  pgrad:  0.09375442 
iter:  500  f-value:  75.44107  pgrad:  0.5117253 
iter:  510  f-value:  75.44074  pgrad:  0.1715944 
iter:  520  f-value:  75.44044  pgrad:  0.5023858 
iter:  530  f-value:  75.43738  pgrad:  0.0318289 
iter:  540  f-value:  75.43714  pgrad:  0.2235234 
iter:  550  f-value:  75.43687  pgrad:  0.1494136 
iter:  560  f-value:  75.43669  pgrad:  0.03120854 
iter:  570  f-value:  75.43575  pgrad:  0.5727769 
iter:  580  f-value:  75.43508  pgrad:  0.03290832 
iter:  590  f-value:  75.43486  pgrad:  0.1428782 
iter:  600  f-value:  75.43422  pgrad:  0.08554395 
iter:  610  f-value:  75.43396  pgrad:  0.03152981 
iter:  620  f-value:  75.43354  pgrad:  0.03493674 
iter:  630  f-value:  75.43327  pgrad:  0.03204917 
iter:  640  f-value:  75.43307  pgrad:  0.03056668 
iter:  650  f-value:  75.43267  pgrad:  0.03100655 
iter:  660  f-value:  75.43084  pgrad:  0.03057014 
iter:  670  f-value:  75.43053  pgrad:  0.4856592 
iter:  680  f-value:  75.42998  pgrad:  0.03107177 
iter:  690  f-value:  75.42956  pgrad:  0.0312711 
iter:  700  f-value:  75.42911  pgrad:  0.08352193 
iter:  710  f-value:  75.42881  pgrad:  0.1353801 
iter:  720  f-value:  75.42865  pgrad:  0.03061039 
iter:  730  f-value:  75.42823  pgrad:  0.2526101 
iter:  740  f-value:  75.42803  pgrad:  0.03052182 
iter:  750  f-value:  75.42768  pgrad:  0.03084891 
iter:  760  f-value:  75.42203  pgrad:  0.4893587 
iter:  770  f-value:  75.42138  pgrad:  0.03069867 
iter:  780  f-value:  75.42062  pgrad:  0.1064028 
iter:  790  f-value:  75.42048  pgrad:  0.2550211 
iter:  800  f-value:  75.41867  pgrad:  0.809789 
iter:  810  f-value:  75.41734  pgrad:  0.2371823 
iter:  820  f-value:  75.41701  pgrad:  0.03006038 
iter:  830  f-value:  75.41663  pgrad:  0.03023349 
iter:  840  f-value:  75.4152  pgrad:  0.03016722 
iter:  850  f-value:  75.41446  pgrad:  0.1892659 
iter:  860  f-value:  75.41225  pgrad:  0.1855582 
iter:  870  f-value:  75.41207  pgrad:  0.02994586 
iter:  880  f-value:  75.41169  pgrad:  0.03023247 
iter:  890  f-value:  75.41133  pgrad:  0.02977338 
iter:  900  f-value:  75.41037  pgrad:  0.03368838 
iter:  910  f-value:  75.40994  pgrad:  0.05401776 
iter:  920  f-value:  75.40976  pgrad:  0.2481569 
iter:  930  f-value:  75.40899  pgrad:  0.04353847 
iter:  940  f-value:  75.40872  pgrad:  0.03210169 
iter:  950  f-value:  75.40854  pgrad:  0.0302581 
iter:  960  f-value:  75.40817  pgrad:  0.0300477 
iter:  970  f-value:  75.39823  pgrad:  0.07379797 
iter:  980  f-value:  75.39781  pgrad:  0.02912736 
iter:  990  f-value:  75.39748  pgrad:  0.03009926 
iter:  1000  f-value:  75.39726  pgrad:  0.3539792 
iter:  1010  f-value:  75.3968  pgrad:  0.08858869 
iter:  1020  f-value:  75.39597  pgrad:  0.3451493 
iter:  1030  f-value:  75.39569  pgrad:  0.04772142 
iter:  1040  f-value:  75.39542  pgrad:  0.5186995 
iter:  1050  f-value:  75.39479  pgrad:  0.02918089 
iter:  1060  f-value:  75.39452  pgrad:  0.06342049 
iter:  1070  f-value:  75.39449  pgrad:  1.190819 
iter:  1080  f-value:  75.39351  pgrad:  0.02925882 
iter:  1090  f-value:  75.39313  pgrad:  0.03025179 
iter:  1100  f-value:  75.39232  pgrad:  0.08740478 
iter:  1110  f-value:  75.39211  pgrad:  0.02914611 
iter:  1120  f-value:  75.39006  pgrad:  0.03678107 
iter:  1130  f-value:  75.38982  pgrad:  0.02890061 
iter:  1140  f-value:  75.38953  pgrad:  0.02941586 
iter:  1150  f-value:  75.3891  pgrad:  0.06074461 
iter:  1160  f-value:  75.38889  pgrad:  0.0292772 
iter:  1170  f-value:  75.38279  pgrad:  0.02893115 
iter:  1180  f-value:  75.38186  pgrad:  0.0286138 
iter:  1190  f-value:  75.38148  pgrad:  0.3289659 
iter:  1200  f-value:  75.38049  pgrad:  0.9935544 
iter:  1210  f-value:  75.37926  pgrad:  0.02995849 
iter:  1220  f-value:  75.37903  pgrad:  0.02932441 
iter:  1230  f-value:  75.37872  pgrad:  0.03057187 
iter:  1240  f-value:  75.37855  pgrad:  0.02892212 
iter:  1250  f-value:  75.37794  pgrad:  0.03573158 
iter:  1260  f-value:  75.37771  pgrad:  0.09448316 
iter:  1270  f-value:  75.37757  pgrad:  0.02845001 
iter:  1280  f-value:  75.37665  pgrad:  0.02892158 
iter:  1290  f-value:  75.37569  pgrad:  0.02845098 
iter:  1300  f-value:  75.37517  pgrad:  0.1395639 
iter:  1310  f-value:  75.37434  pgrad:  0.4036028 
iter:  1320  f-value:  75.37327  pgrad:  0.02858177 
iter:  1330  f-value:  75.37066  pgrad:  0.02935513 
iter:  1340  f-value:  75.37007  pgrad:  0.03112016 
iter:  1350  f-value:  75.36984  pgrad:  0.146832 
iter:  1360  f-value:  75.3697  pgrad:  0.02855237 
iter:  1370  f-value:  75.3689  pgrad:  0.0285199 
iter:  1380  f-value:  75.36879  pgrad:  0.02848574 
iter:  1390  f-value:  75.36283  pgrad:  0.02836975 
iter:  1400  f-value:  75.34671  pgrad:  0.1097121 
iter:  1410  f-value:  75.34624  pgrad:  0.05850968 
iter:  1420  f-value:  75.34612  pgrad:  0.03418858 
iter:  1430  f-value:  75.3447  pgrad:  0.02758287 
iter:  1440  f-value:  75.33419  pgrad:  0.0801309 
iter:  1450  f-value:  75.33403  pgrad:  0.03149046 
iter:  1460  f-value:  75.33385  pgrad:  0.03004465 
iter:  1470  f-value:  75.33355  pgrad:  0.4372514 
iter:  1480  f-value:  75.33335  pgrad:  0.02718205 
iter:  1490  f-value:  75.33308  pgrad:  0.02664908 
iter:  1500  f-value:  75.33294  pgrad:  0.0269646 
Score: 1.000075  Hessian: 3.118142e-07 
Warning messages:
1: In mlt(m, data = d) : NB not met
2: In spg(par = beta, fn = loglikfct, project = "projectLinear", projectArgs = list(A = ui,  :
  Unsuccessful convergence.
3: In spg(par = beta, fn = loglikfct, gr = scorefct, project = "projectLinear",  :
  Unsuccessful convergence.
4: In spg(par = beta, fn = loglikfct, gr = scorefct, project = "projectLinear",  :
  Unsuccessful convergence.
5: In mlt(m, data = d) : algorithm did not converge
> 1 / coef(o)[2]
        2 
0.2609495 
> p <- predict(Bb,
+              newdata = data.frame(x = x), coef = coef(o)[-(1:2)])
> plot(x, y)
> lines(sort(x), -p[order(x)] / coef(o)[2], lwd = 2, col = "red")
> 
> x <- runif(n, max = 2 * pi)
> y <- rnorm(n, 2, 1.1 + sin(x) / 2)
> d <- data.frame(y = y, x = x)
> 
> plot(x, y)
> 
> Bb <- Bernstein_basis(order = 10, support = c(0, 2*pi), var = "x")
> m <- model(lin, interacting = Bb, remove_intercept = TRUE)
> 
> o <- mlt(m, data = d)
Note: method with signature 'diagonalMatrix#Matrix' chosen for function 'kronecker',
 target signature 'ddiMatrix#ddiMatrix'.
 "Matrix#diagonalMatrix" would also be valid
Note: method with signature 'TsparseMatrix#sparseMatrix' chosen for function 'kronecker',
 target signature 'dtTMatrix#ddiMatrix'.
 "Matrix#diagonalMatrix" would also be valid
Note: method with signature 'Matrix#numLike' chosen for function '%*%',
 target signature 'dgTMatrix#numeric'.
 "TsparseMatrix#ANY" would also be valid
Note: method with signature 'Matrix#matrix' chosen for function '%*%',
 target signature 'dgTMatrix#matrix'.
 "TsparseMatrix#ANY" would also be valid
iter:  0  f-value:  1536.701  pgrad:  65.26157 
iter:  10  f-value:  1461.028  pgrad:  23.3694 
iter:  20  f-value:  1432.495  pgrad:  3.59159 
iter:  30  f-value:  1430.076  pgrad:  13.46055 
iter:  40  f-value:  1426.081  pgrad:  1.320802 
iter:  50  f-value:  1425.612  pgrad:  1.339031 
iter:  60  f-value:  1424.662  pgrad:  3.104687 
iter:  70  f-value:  1424.327  pgrad:  1.001338 
iter:  80  f-value:  1424.067  pgrad:  0.9882547 
iter:  90  f-value:  1421.642  pgrad:  1.28266 
iter:  100  f-value:  1421.591  pgrad:  3.556286 
iter:  110  f-value:  1421.484  pgrad:  0.4925505 
iter:  120  f-value:  1421.437  pgrad:  0.3938271 
iter:  130  f-value:  1421.32  pgrad:  0.5983156 
iter:  140  f-value:  1421.244  pgrad:  1.17944 
iter:  150  f-value:  1421.205  pgrad:  0.3655123 
iter:  160  f-value:  1421.143  pgrad:  0.3574837 
iter:  170  f-value:  1421.071  pgrad:  0.4038498 
iter:  180  f-value:  1421.034  pgrad:  0.474879 
iter:  190  f-value:  1420.941  pgrad:  1.095431 
iter:  200  f-value:  1420.907  pgrad:  0.2957631 
iter:  0  f-value:  1420.906  pgrad:  0.299426 
iter:  10  f-value:  1420.835  pgrad:  0.2774337 
iter:  20  f-value:  1420.799  pgrad:  0.2522268 
iter:  30  f-value:  1420.787  pgrad:  1.598994 
iter:  40  f-value:  1420.765  pgrad:  0.2487631 
iter:  50  f-value:  1420.75  pgrad:  0.2379133 
iter:  60  f-value:  1420.727  pgrad:  0.4579444 
iter:  70  f-value:  1420.701  pgrad:  0.6283359 
iter:  80  f-value:  1420.683  pgrad:  0.2137597 
iter:  90  f-value:  1420.673  pgrad:  0.2100969 
iter:  100  f-value:  1420.656  pgrad:  0.2081086 
iter:  110  f-value:  1420.643  pgrad:  0.2918519 
iter:  120  f-value:  1420.628  pgrad:  1.118493 
iter:  130  f-value:  1420.6  pgrad:  0.1899559 
iter:  140  f-value:  1420.59  pgrad:  0.1878791 
iter:  150  f-value:  1420.583  pgrad:  0.1900718 
iter:  160  f-value:  1420.57  pgrad:  0.1843824 
iter:  170  f-value:  1420.559  pgrad:  0.1908295 
iter:  180  f-value:  1420.556  pgrad:  0.892997 
iter:  190  f-value:  1420.548  pgrad:  0.2202299 
iter:  200  f-value:  1420.539  pgrad:  0.1587268 
iter:  210  f-value:  1420.534  pgrad:  0.1660919 
iter:  220  f-value:  1420.527  pgrad:  0.1674038 
iter:  230  f-value:  1420.519  pgrad:  0.1630255 
iter:  240  f-value:  1420.514  pgrad:  1.198401 
iter:  250  f-value:  1420.506  pgrad:  0.1626836 
iter:  260  f-value:  1420.497  pgrad:  0.1555235 
iter:  270  f-value:  1420.492  pgrad:  0.2311677 
iter:  280  f-value:  1420.487  pgrad:  0.1652174 
iter:  290  f-value:  1420.48  pgrad:  0.1558974 
iter:  300  f-value:  1420.475  pgrad:  0.1540758 
iter:  310  f-value:  1420.471  pgrad:  0.933631 
iter:  320  f-value:  1420.464  pgrad:  0.1356197 
iter:  330  f-value:  1420.46  pgrad:  0.1407354 
iter:  340  f-value:  1420.456  pgrad:  0.1392798 
iter:  350  f-value:  1420.451  pgrad:  0.1395912 
iter:  360  f-value:  1420.439  pgrad:  0.1485261 
iter:  370  f-value:  1420.436  pgrad:  0.1383744 
iter:  380  f-value:  1420.432  pgrad:  0.1338877 
iter:  390  f-value:  1420.427  pgrad:  0.1665009 
iter:  400  f-value:  1420.425  pgrad:  0.1358868 
iter:  410  f-value:  1420.42  pgrad:  0.1374754 
iter:  420  f-value:  1420.415  pgrad:  0.1279664 
iter:  430  f-value:  1420.411  pgrad:  0.1240265 
iter:  440  f-value:  1420.408  pgrad:  0.1273724 
iter:  450  f-value:  1420.403  pgrad:  0.126605 
iter:  460  f-value:  1420.398  pgrad:  0.278308 
iter:  470  f-value:  1420.392  pgrad:  0.1427147 
iter:  480  f-value:  1420.389  pgrad:  0.1072806 
iter:  490  f-value:  1420.385  pgrad:  0.1151108 
iter:  500  f-value:  1420.377  pgrad:  0.1039767 
iter:  510  f-value:  1420.366  pgrad:  1.129437 
iter:  520  f-value:  1420.359  pgrad:  0.1049901 
iter:  530  f-value:  1420.357  pgrad:  0.1049904 
iter:  540  f-value:  1420.322  pgrad:  0.9563976 
iter:  550  f-value:  1420.318  pgrad:  0.0905362 
iter:  560  f-value:  1420.316  pgrad:  0.09021862 
iter:  570  f-value:  1420.285  pgrad:  0.264788 
iter:  580  f-value:  1420.283  pgrad:  0.08092062 
iter:  590  f-value:  1420.281  pgrad:  0.08286623 
iter:  600  f-value:  1420.28  pgrad:  0.07953501 
iter:  610  f-value:  1420.277  pgrad:  0.204382 
iter:  620  f-value:  1420.276  pgrad:  0.1613594 
iter:  630  f-value:  1420.27  pgrad:  0.1326343 
iter:  640  f-value:  1420.251  pgrad:  0.07559109 
iter:  650  f-value:  1420.249  pgrad:  0.07256555 
iter:  660  f-value:  1420.248  pgrad:  0.07342755 
iter:  670  f-value:  1420.244  pgrad:  0.07174164 
iter:  680  f-value:  1420.176  pgrad:  0.2374236 
iter:  690  f-value:  1420.175  pgrad:  0.05924472 
iter:  700  f-value:  1420.171  pgrad:  0.05996663 
iter:  710  f-value:  1420.169  pgrad:  0.05953484 
iter:  720  f-value:  1420.168  pgrad:  0.05743731 
iter:  730  f-value:  1420.159  pgrad:  0.0576767 
iter:  740  f-value:  1420.157  pgrad:  0.06774079 
iter:  750  f-value:  1420.156  pgrad:  0.05615609 
iter:  760  f-value:  1420.155  pgrad:  0.1021578 
iter:  770  f-value:  1420.151  pgrad:  0.1597147 
iter:  780  f-value:  1420.151  pgrad:  0.05525224 
iter:  790  f-value:  1420.144  pgrad:  0.05381784 
iter:  800  f-value:  1420.14  pgrad:  0.09535621 
iter:  810  f-value:  1420.138  pgrad:  0.07375371 
iter:  820  f-value:  1420.13  pgrad:  0.4459655 
iter:  830  f-value:  1420.127  pgrad:  0.526941 
iter:  840  f-value:  1420.126  pgrad:  0.0519636 
iter:  850  f-value:  1420.12  pgrad:  0.0561035 
iter:  860  f-value:  1420.119  pgrad:  0.07370661 
iter:  870  f-value:  1420.117  pgrad:  0.05455417 
iter:  880  f-value:  1420.115  pgrad:  0.04507073 
iter:  890  f-value:  1420.114  pgrad:  0.3880452 
iter:  900  f-value:  1420.112  pgrad:  0.04926694 
iter:  910  f-value:  1420.11  pgrad:  0.0535484 
iter:  920  f-value:  1420.108  pgrad:  0.09041404 
iter:  930  f-value:  1420.107  pgrad:  0.1164645 
iter:  940  f-value:  1420.107  pgrad:  0.6699998 
iter:  950  f-value:  1420.104  pgrad:  0.3410778 
iter:  960  f-value:  1420.104  pgrad:  0.531343 
iter:  970  f-value:  1420.101  pgrad:  0.04672224 
iter:  980  f-value:  1420.101  pgrad:  0.9213411 
iter:  990  f-value:  1420.099  pgrad:  0.04888297 
iter:  1000  f-value:  1420.098  pgrad:  0.05099224 
iter:  1010  f-value:  1420.097  pgrad:  0.0496369 
iter:  1020  f-value:  1420.089  pgrad:  0.8337985 
iter:  1030  f-value:  1420.086  pgrad:  1.053103 
iter:  1040  f-value:  1420.082  pgrad:  0.04691823 
iter:  1050  f-value:  1420.079  pgrad:  0.06770858 
iter:  1060  f-value:  1420.078  pgrad:  0.8414638 
iter:  1070  f-value:  1420.075  pgrad:  0.04830677 
iter:  1080  f-value:  1420.074  pgrad:  0.04720312 
iter:  1090  f-value:  1420.074  pgrad:  0.4194086 
iter:  1100  f-value:  1420.072  pgrad:  0.07526933 
iter:  1110  f-value:  1420.07  pgrad:  0.04568251 
iter:  1120  f-value:  1420.069  pgrad:  0.06598595 
iter:  1130  f-value:  1420.067  pgrad:  0.5973749 
iter:  1140  f-value:  1420.017  pgrad:  0.04347483 
iter:  1150  f-value:  1420.016  pgrad:  0.3184697 
iter:  1160  f-value:  1420.016  pgrad:  0.8501425 
iter:  1170  f-value:  1420.014  pgrad:  0.03999338 
iter:  1180  f-value:  1420.013  pgrad:  0.0416363 
iter:  1190  f-value:  1419.995  pgrad:  0.1408716 
iter:  1200  f-value:  1419.995  pgrad:  0.5056174 
iter:  1210  f-value:  1419.993  pgrad:  0.08362451 
iter:  1220  f-value:  1419.991  pgrad:  0.04072 
iter:  1230  f-value:  1419.985  pgrad:  0.03893765 
iter:  1240  f-value:  1419.984  pgrad:  0.03873168 
iter:  1250  f-value:  1419.983  pgrad:  0.2143723 
iter:  1260  f-value:  1419.983  pgrad:  0.04104262 
iter:  1270  f-value:  1419.981  pgrad:  0.03766368 
iter:  1280  f-value:  1419.981  pgrad:  0.4545012 
iter:  1290  f-value:  1419.98  pgrad:  0.0390394 
iter:  1300  f-value:  1419.979  pgrad:  0.0406984 
iter:  1310  f-value:  1419.978  pgrad:  0.2439875 
iter:  1320  f-value:  1419.977  pgrad:  0.05567611 
iter:  1330  f-value:  1419.976  pgrad:  0.04080819 
iter:  1340  f-value:  1419.974  pgrad:  0.03807737 
iter:  1350  f-value:  1419.969  pgrad:  0.3112445 
iter:  1360  f-value:  1419.969  pgrad:  0.03759934 
iter:  1370  f-value:  1419.959  pgrad:  0.04714675 
iter:  1380  f-value:  1419.958  pgrad:  0.03771784 
iter:  1390  f-value:  1419.956  pgrad:  0.04175195 
iter:  1400  f-value:  1419.955  pgrad:  0.03748335 
iter:  1410  f-value:  1419.955  pgrad:  0.325062 
iter:  1420  f-value:  1419.954  pgrad:  0.03778475 
iter:  1430  f-value:  1419.953  pgrad:  0.04115328 
iter:  1440  f-value:  1419.953  pgrad:  0.03938597 
iter:  1450  f-value:  1419.952  pgrad:  0.03701202 
iter:  1460  f-value:  1419.952  pgrad:  0.6720385 
iter:  1470  f-value:  1419.951  pgrad:  0.04007641 
iter:  1480  f-value:  1419.95  pgrad:  0.03988561 
iter:  1490  f-value:  1419.95  pgrad:  0.03850667 
iter:  1500  f-value:  1419.949  pgrad:  0.03631835 
iter:  0  f-value:  1419.949  pgrad:  0.03954111 
iter:  10  f-value:  1419.947  pgrad:  0.03765096 
iter:  20  f-value:  1419.946  pgrad:  0.03853371 
iter:  30  f-value:  1419.946  pgrad:  0.05633339 
iter:  40  f-value:  1419.945  pgrad:  0.3279712 
iter:  50  f-value:  1419.944  pgrad:  0.04029212 
iter:  60  f-value:  1419.944  pgrad:  0.06006969 
iter:  70  f-value:  1419.943  pgrad:  0.4900359 
iter:  80  f-value:  1419.942  pgrad:  0.1464479 
iter:  90  f-value:  1419.941  pgrad:  0.1282284 
iter:  100  f-value:  1419.941  pgrad:  0.04209376 
iter:  110  f-value:  1419.941  pgrad:  0.04747952 
iter:  120  f-value:  1419.94  pgrad:  0.03594381 
iter:  130  f-value:  1419.939  pgrad:  0.2635673 
iter:  140  f-value:  1419.939  pgrad:  0.03832184 
iter:  150  f-value:  1419.938  pgrad:  0.04197075 
iter:  160  f-value:  1419.938  pgrad:  0.1296138 
iter:  170  f-value:  1419.938  pgrad:  0.03590314 
iter:  180  f-value:  1419.937  pgrad:  0.1452918 
iter:  190  f-value:  1419.937  pgrad:  0.03747797 
iter:  200  f-value:  1419.936  pgrad:  0.04191422 
iter:  210  f-value:  1419.936  pgrad:  0.04277116 
iter:  220  f-value:  1419.935  pgrad:  0.3078 
iter:  230  f-value:  1419.935  pgrad:  0.1400729 
iter:  240  f-value:  1419.934  pgrad:  0.04852848 
iter:  250  f-value:  1419.934  pgrad:  0.06728315 
iter:  260  f-value:  1419.933  pgrad:  0.04134132 
iter:  270  f-value:  1419.933  pgrad:  0.03957279 
iter:  280  f-value:  1419.933  pgrad:  0.04247763 
iter:  290  f-value:  1419.932  pgrad:  0.04250312 
iter:  300  f-value:  1419.932  pgrad:  0.04259588 
iter:  310  f-value:  1419.931  pgrad:  0.04077779 
iter:  320  f-value:  1419.931  pgrad:  0.1026901 
iter:  330  f-value:  1419.93  pgrad:  0.1252505 
iter:  340  f-value:  1419.929  pgrad:  0.0443537 
iter:  350  f-value:  1419.929  pgrad:  0.04079497 
iter:  360  f-value:  1419.929  pgrad:  0.03428161 
iter:  370  f-value:  1419.928  pgrad:  0.04157003 
iter:  380  f-value:  1419.928  pgrad:  0.0393594 
iter:  390  f-value:  1419.927  pgrad:  0.03890774 
iter:  400  f-value:  1419.926  pgrad:  0.2753271 
iter:  410  f-value:  1419.925  pgrad:  0.08936243 
iter:  420  f-value:  1419.925  pgrad:  0.3522355 
iter:  430  f-value:  1419.924  pgrad:  0.03727843 
iter:  440  f-value:  1419.924  pgrad:  0.0342543 
iter:  450  f-value:  1419.923  pgrad:  0.03931575 
iter:  460  f-value:  1419.923  pgrad:  0.03914784 
iter:  470  f-value:  1419.923  pgrad:  0.03928101 
iter:  480  f-value:  1419.922  pgrad:  0.1856838 
iter:  490  f-value:  1419.922  pgrad:  0.03938629 
iter:  500  f-value:  1419.921  pgrad:  0.03859349 
iter:  510  f-value:  1419.92  pgrad:  0.03789457 
iter:  520  f-value:  1419.92  pgrad:  0.03882074 
iter:  530  f-value:  1419.92  pgrad:  0.310656 
iter:  540  f-value:  1419.919  pgrad:  0.03740778 
iter:  550  f-value:  1419.918  pgrad:  0.2208661 
iter:  560  f-value:  1419.918  pgrad:  0.04326469 
iter:  570  f-value:  1419.918  pgrad:  0.05127742 
iter:  580  f-value:  1419.917  pgrad:  0.04203033 
iter:  590  f-value:  1419.917  pgrad:  0.03841097 
iter:  600  f-value:  1419.917  pgrad:  0.4819581 
iter:  610  f-value:  1419.916  pgrad:  0.03647164 
iter:  620  f-value:  1419.915  pgrad:  0.09048959 
iter:  630  f-value:  1419.915  pgrad:  0.03521787 
iter:  640  f-value:  1419.915  pgrad:  0.03626839 
iter:  650  f-value:  1419.914  pgrad:  0.04178158 
iter:  660  f-value:  1419.914  pgrad:  0.349375 
iter:  670  f-value:  1419.913  pgrad:  0.03674917 
iter:  680  f-value:  1419.913  pgrad:  0.03978689 
iter:  690  f-value:  1419.912  pgrad:  0.03548424 
iter:  700  f-value:  1419.912  pgrad:  0.03564373 
iter:  710  f-value:  1419.911  pgrad:  0.03755949 
iter:  720  f-value:  1419.91  pgrad:  0.09378638 
iter:  730  f-value:  1419.91  pgrad:  0.04339715 
iter:  740  f-value:  1419.909  pgrad:  0.3503796 
iter:  750  f-value:  1419.909  pgrad:  0.1200585 
iter:  760  f-value:  1419.908  pgrad:  0.03546372 
iter:  770  f-value:  1419.908  pgrad:  0.03831474 
iter:  780  f-value:  1419.907  pgrad:  0.03473594 
iter:  790  f-value:  1419.906  pgrad:  0.03636603 
iter:  800  f-value:  1419.905  pgrad:  0.1224675 
iter:  810  f-value:  1419.905  pgrad:  0.2583672 
iter:  820  f-value:  1419.904  pgrad:  0.3139635 
iter:  830  f-value:  1419.904  pgrad:  0.05274824 
iter:  840  f-value:  1419.903  pgrad:  0.03784463 
iter:  850  f-value:  1419.903  pgrad:  0.08105957 
iter:  860  f-value:  1419.902  pgrad:  0.03542175 
iter:  870  f-value:  1419.902  pgrad:  0.0337342 
iter:  880  f-value:  1419.902  pgrad:  0.5832054 
iter:  890  f-value:  1419.901  pgrad:  0.03531275 
iter:  900  f-value:  1419.9  pgrad:  0.03371005 
iter:  910  f-value:  1419.899  pgrad:  0.03449886 
iter:  920  f-value:  1419.899  pgrad:  0.04857104 
iter:  930  f-value:  1419.899  pgrad:  0.03575586 
iter:  940  f-value:  1419.898  pgrad:  0.03352395 
iter:  950  f-value:  1419.897  pgrad:  0.04244801 
iter:  960  f-value:  1419.897  pgrad:  0.08134067 
iter:  970  f-value:  1419.896  pgrad:  0.1144601 
iter:  980  f-value:  1419.896  pgrad:  0.1544613 
iter:  990  f-value:  1419.896  pgrad:  0.1840426 
iter:  1000  f-value:  1419.896  pgrad:  0.1841497 
iter:  1010  f-value:  1419.895  pgrad:  0.1706265 
iter:  1020  f-value:  1419.895  pgrad:  0.1685254 
iter:  1030  f-value:  1419.895  pgrad:  0.1659485 
iter:  1040  f-value:  1419.894  pgrad:  0.1652358 
iter:  1050  f-value:  1419.894  pgrad:  0.1648222 
iter:  1060  f-value:  1419.894  pgrad:  0.1645506 
iter:  1070  f-value:  1419.893  pgrad:  0.1644335 
iter:  1080  f-value:  1419.893  pgrad:  0.1644391 
iter:  1090  f-value:  1419.893  pgrad:  0.1645405 
iter:  1100  f-value:  1419.892  pgrad:  0.1647223 
iter:  1110  f-value:  1419.892  pgrad:  0.1649754 
iter:  1120  f-value:  1419.892  pgrad:  0.1652939 
iter:  1130  f-value:  1419.891  pgrad:  0.1656736 
iter:  1140  f-value:  1419.891  pgrad:  0.1661114 
iter:  1150  f-value:  1419.891  pgrad:  0.1666043 
iter:  1160  f-value:  1419.891  pgrad:  0.1671492 
iter:  1170  f-value:  1419.89  pgrad:  0.1677427 
iter:  1180  f-value:  1419.89  pgrad:  0.1683809 
iter:  1190  f-value:  1419.89  pgrad:  0.1690593 
iter:  1200  f-value:  1419.889  pgrad:  0.1697729 
iter:  1210  f-value:  1419.889  pgrad:  0.1705162 
iter:  1220  f-value:  1419.889  pgrad:  0.1712838 
iter:  1230  f-value:  1419.889  pgrad:  0.17207 
iter:  1240  f-value:  1419.888  pgrad:  0.1728697 
iter:  1250  f-value:  1419.888  pgrad:  0.1736783 
iter:  1260  f-value:  1419.888  pgrad:  0.1744915 
iter:  1270  f-value:  1419.887  pgrad:  0.175306 
iter:  1280  f-value:  1419.887  pgrad:  0.176119 
iter:  1290  f-value:  1419.887  pgrad:  0.1769283 
iter:  1300  f-value:  1419.887  pgrad:  0.177732 
iter:  1310  f-value:  1419.886  pgrad:  0.1785288 
iter:  1320  f-value:  1419.886  pgrad:  0.1793174 
iter:  1330  f-value:  1419.886  pgrad:  0.1800969 
iter:  1340  f-value:  1419.885  pgrad:  0.1808662 
iter:  1350  f-value:  1419.885  pgrad:  0.1816245 
iter:  1360  f-value:  1419.885  pgrad:  0.1823708 
iter:  1370  f-value:  1419.885  pgrad:  0.1831043 
iter:  1380  f-value:  1419.884  pgrad:  0.1838237 
iter:  1390  f-value:  1419.884  pgrad:  0.1845282 
iter:  1400  f-value:  1419.884  pgrad:  0.1852166 
iter:  1410  f-value:  1419.883  pgrad:  0.1858876 
iter:  1420  f-value:  1419.883  pgrad:  0.18654 
iter:  1430  f-value:  1419.883  pgrad:  0.1871724 
iter:  1440  f-value:  1419.883  pgrad:  0.1877831 
iter:  1450  f-value:  1419.882  pgrad:  0.1883708 
iter:  1460  f-value:  1419.882  pgrad:  0.1889334 
iter:  1470  f-value:  1419.882  pgrad:  0.1894692 
iter:  1480  f-value:  1419.882  pgrad:  0.1899761 
iter:  1490  f-value:  1419.881  pgrad:  0.1904517 
iter:  1500  f-value:  1419.881  pgrad:  0.1908937 
Score: 1.000001  Hessian: 0.01301872 
Warning messages:
1: In mlt(m, data = d) : NB not met
2: In spg(par = beta, fn = loglikfct, project = "projectLinear", projectArgs = list(A = ui,  :
  Unsuccessful convergence.
3: In spg(par = beta, fn = loglikfct, gr = scorefct, project = "projectLinear",  :
  Unsuccessful convergence.
4: In spg(par = beta, fn = loglikfct, gr = scorefct, project = "projectLinear",  :
  Unsuccessful convergence.
5: In mlt(m, data = d) : algorithm did not converge
> 
> nd <- data.frame(x = sort(x))
> layout(matrix(1:2, nr = 2))
> tmp <- matrix(coef(o), nrow = 2)
> plot(nd$x, predict(Bb, nd, coef = tmp[1,]))
> plot(nd$x, predict(Bb, nd, coef = tmp[2,]))
> lines(nd$x, 1.1 + sin(nd$x) / 2, col = "red")
> 
> proc.time()
   user  system elapsed 
 12.101   0.172  12.273 
