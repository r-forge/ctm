
R version 3.1.2 (2014-10-31) -- "Pumpkin Helmet"
Copyright (C) 2014 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("MASS")
> 
> mp <- polr(Sat ~ Infl, weights = Freq, data = housing)
> 
> library("mlt")
Loading required package: basefun
Loading required package: Matrix
Loading required package: polynom
Loading required package: numDeriv
> 
> s <- as.basis(~ Infl, data = housing, remove_intercept = TRUE)
> r <- as.basis(~ Sat, data = housing, remove_intercept = TRUE,
+               contrasts.arg = list(Sat = function(n) 
+                   contr.treatment(n, base = 3)),
+               ui = diff(Diagonal(2)), ci = 0)
> 
> m <- model(r, shift = s, todist = "Logi")
> 
> mod <- mlt(m, housing, weights = housing$Freq)
iter:  0  f-value:  1982.846  pgrad:  114.1486 
iter:  10  f-value:  1797.975  pgrad:  27.66131 
iter:  20  f-value:  1772.448  pgrad:  4.781332 
iter:  30  f-value:  1771.721  pgrad:  3.539469 
iter:  40  f-value:  1771.708  pgrad:  0.003074092 
iter:  50  f-value:  1771.708  pgrad:  0.0002250999 
iter:  0  f-value:  1771.708  pgrad:  1.956054e-05 
Score: 1.000194  Hessian: 2.373008e-08 
Warning message:
In mlt(m, housing, weights = housing$Freq) : NB not met
> 
> logLik(mp)
'log Lik.' -1771.708 (df=4)
> logLik(mod)
'log Lik.' -1771.708 (df=4)
> 
> coef(mp)
InflMedium   InflHigh 
 0.5635756  1.2486832 
> mp$zeta
 Low|Medium Medium|High 
 -0.2013727   0.9484658 
> coef(mod)
      Sat1       Sat2 InflMedium   InflHigh 
-0.2013763  0.9484755 -0.5635787 -1.2486719 
> 
> sqrt(diag(vcov(mp)))

Re-fitting to get Hessian

 InflMedium    InflHigh  Low|Medium Medium|High 
 0.10357053  0.12479361  0.07662596  0.08024304 
> sqrt(diag(vcov(mod)))
      Sat1       Sat2 InflMedium   InflHigh 
0.07662594 0.08024300 0.10357051 0.12479358 
> 
> proc.time()
   user  system elapsed 
  1.847   0.042   1.877 
