
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 	
> library("sltm")
Loading required package: mlt
Loading required package: basefun
Loading required package: variables
> library("multcomp")
Loading required package: mvtnorm
Loading required package: survival
Loading required package: TH.data
> 
> (a <- sltm(Sepal.Length | Species ~ Sepal.Width, data = iris, trafo = "log"))
  Successful convergence.

Call:
sltm(formula = Sepal.Length | Species ~ Sepal.Width, data = iris, 
    trafo = "log")
Model: 
Coefficients:
    log(Sepal.Length):Speciessetosa log(Sepal.Length):Speciesversicolor 
                          13.807061                           10.167397 
 log(Sepal.Length):Speciesvirginica                         Sepal.Width 
                          10.263752                            6.437371 
> summary(a)

Call:
sltm(formula = Sepal.Length | Species ~ Sepal.Width, data = iris, 
    trafo = "log")
Model:  continuous stratified linear transformation model (transformed logistic distribution)
	continuous stratified proportional odds model
Coefficients (response transformation):
    log(Sepal.Length):Speciessetosa log(Sepal.Length):Speciesversicolor 
                           13.80706                            10.16740 
 log(Sepal.Length):Speciesvirginica 
                           10.26375 

Coefficients (linear predictor):
                 Estimate Std. Error z value Pr(>|z|)    
Sepal.Width == 0   6.4374     0.4427   14.54   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

AIC: 406.6964
Log-Likelihood: -199.3482 (df = 4)
> coef(a)
Sepal.Width 
   6.437371 
> vcov(a)
            Sepal.Width
Sepal.Width   0.1960146
> predict(a)
  [1] -22.53080 -19.31211 -20.59959 -19.95585 -23.17454 -25.10575 -21.88706
  [8] -21.88706 -18.66838 -19.95585 -23.81827 -21.88706 -19.31211 -19.31211
 [15] -25.74948 -28.32443 -25.10575 -22.53080 -24.46201 -24.46201 -21.88706
 [22] -23.81827 -23.17454 -21.24332 -21.88706 -19.31211 -21.88706 -22.53080
 [29] -21.88706 -20.59959 -19.95585 -21.88706 -26.39322 -27.03696 -19.95585
 [36] -20.59959 -22.53080 -23.17454 -19.31211 -21.88706 -22.53080 -14.80595
 [43] -20.59959 -22.53080 -24.46201 -19.31211 -24.46201 -20.59959 -23.81827
 [50] -21.24332 -20.59959 -20.59959 -19.95585 -14.80595 -18.02464 -18.02464
 [57] -21.24332 -15.44969 -18.66838 -17.38090 -12.87474 -19.31211 -14.16222
 [64] -18.66838 -18.66838 -19.95585 -19.31211 -17.38090 -14.16222 -16.09343
 [71] -20.59959 -18.02464 -16.09343 -18.02464 -18.66838 -19.31211 -18.02464
 [78] -19.31211 -18.66838 -16.73716 -15.44969 -15.44969 -17.38090 -17.38090
 [85] -19.31211 -21.88706 -19.95585 -14.80595 -19.31211 -16.09343 -16.73716
 [92] -19.31211 -16.73716 -14.80595 -17.38090 -19.31211 -18.66838 -18.66838
 [99] -16.09343 -18.02464 -21.24332 -17.38090 -19.31211 -18.66838 -19.31211
[106] -19.31211 -16.09343 -18.66838 -16.09343 -23.17454 -20.59959 -17.38090
[113] -19.31211 -16.09343 -18.02464 -20.59959 -19.31211 -24.46201 -16.73716
[120] -14.16222 -20.59959 -18.02464 -18.02464 -17.38090 -21.24332 -20.59959
[127] -18.02464 -19.31211 -18.02464 -19.31211 -18.02464 -24.46201 -18.02464
[134] -18.02464 -16.73716 -19.31211 -21.88706 -19.95585 -19.31211 -19.95585
[141] -19.95585 -19.95585 -17.38090 -20.59959 -21.24332 -19.31211 -16.09343
[148] -19.31211 -21.88706 -19.31211
> 
> library("survival")
> data("GBSG2", package = "TH.data")
> storage.mode(GBSG2$time) <- "double"
> 
> (b <- sltm(time ~ horTh , data = GBSG2))
  Successful convergence.

Call:
sltm(formula = time ~ horTh, data = GBSG2)
Model: 
Coefficients:
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time)   horThyes 
-4.3923316  0.4580785  0.4580785  0.4580785  1.5347135  6.3422409  0.4780533 
> summary(b)

Call:
sltm(formula = time ~ horTh, data = GBSG2)
Model:  continuous linear transformation model (transformed logistic distribution)
	continuous proportional odds model
Coefficients (response transformation):
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time) 
-4.3923316  0.4580785  0.4580785  0.4580785  1.5347135  6.3422409 

Coefficients (linear predictor):
              Estimate Std. Error z value Pr(>|z|)    
horThyes == 0   0.4781     0.1401   3.413 0.000642 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

AIC: 10700.16
Log-Likelihood: -5343.081 (df = 7)
> coef(b)
 horThyes 
0.4780533 
> vcov(b)
           horThyes
horThyes 0.01961554
> predict(b)
  [1]  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000  0.0000000
  [7] -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
 [13] -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533
 [19] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533
 [25]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
 [31]  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533
 [37]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [43]  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000 -0.4780533
 [49] -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533
 [55]  0.0000000  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533
 [61] -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000
 [67]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [73] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [79]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [85] -0.4780533 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
 [91] -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000
 [97]  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000
[103]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[109]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[115] -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[121]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000
[127] -0.4780533  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000
[133]  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000
[139]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533
[145] -0.4780533 -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000
[151]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
[157] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[163]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[169]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[175]  0.0000000  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533
[181] -0.4780533  0.0000000 -0.4780533 -0.4780533 -0.4780533 -0.4780533
[187]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[193]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000
[199]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[205]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[211]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
[217]  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000
[223] -0.4780533  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533
[229]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[235]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[241] -0.4780533 -0.4780533 -0.4780533  0.0000000 -0.4780533  0.0000000
[247]  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000
[253]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533 -0.4780533
[259] -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533
[265]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[271]  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533 -0.4780533
[277] -0.4780533 -0.4780533  0.0000000  0.0000000 -0.4780533 -0.4780533
[283]  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533 -0.4780533
[289]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
[295] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[301]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000
[307]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[313]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000 -0.4780533
[319] -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000
[325]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[331]  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000 -0.4780533
[337]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000
[343]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533
[349]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533
[355]  0.0000000  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000
[361]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[367]  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000  0.0000000
[373]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[379]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[385] -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533
[391] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[397]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[403]  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000 -0.4780533
[409]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[415] -0.4780533 -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000
[421] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[427]  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000
[433]  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533  0.0000000
[439]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[445]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533
[451]  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000
[457]  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533 -0.4780533
[463]  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533
[469] -0.4780533 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[475] -0.4780533 -0.4780533 -0.4780533 -0.4780533 -0.4780533  0.0000000
[481] -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000
[487] -0.4780533  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533
[493] -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000
[499]  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533 -0.4780533
[505]  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533
[511]  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[517]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[523] -0.4780533 -0.4780533  0.0000000 -0.4780533  0.0000000  0.0000000
[529] -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[535]  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533  0.0000000
[541]  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[547]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000 -0.4780533
[553] -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[559]  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000 -0.4780533
[565]  0.0000000  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[571] -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000
[577]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[583]  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533
[589]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[595]  0.0000000  0.0000000 -0.4780533 -0.4780533 -0.4780533  0.0000000
[601]  0.0000000  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000
[607]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[613]  0.0000000 -0.4780533 -0.4780533  0.0000000 -0.4780533  0.0000000
[619]  0.0000000 -0.4780533  0.0000000  0.0000000  0.0000000  0.0000000
[625]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533 -0.4780533
[631]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[637]  0.0000000  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[643] -0.4780533 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[649] -0.4780533  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533
[655]  0.0000000 -0.4780533 -0.4780533  0.0000000  0.0000000  0.0000000
[661]  0.0000000 -0.4780533  0.0000000  0.0000000 -0.4780533  0.0000000
[667]  0.0000000  0.0000000  0.0000000 -0.4780533 -0.4780533  0.0000000
[673]  0.0000000  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
[679] -0.4780533  0.0000000 -0.4780533  0.0000000 -0.4780533  0.0000000
[685]  0.0000000  0.0000000
> predict(b, newdata = data.frame(horTh = unique(GBSG2$horTh)), q = 500:510, type = "trafo")
       
time         [,1]      [,2]
    500 -1.273198 -1.751251
    501 -1.269124 -1.747177
    502 -1.265057 -1.743110
    503 -1.260997 -1.739050
    504 -1.256944 -1.734998
    505 -1.252899 -1.730952
    506 -1.248860 -1.726914
    507 -1.244829 -1.722882
    508 -1.240805 -1.718858
    509 -1.236787 -1.714841
    510 -1.232777 -1.710830
> 
> (b <- sltm(time ~ 1, data = GBSG2))
  Successful convergence.

Call:
sltm(formula = time ~ 1, data = GBSG2)
Model: 
Coefficients:
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time) 
-4.5307254  0.2960832  0.2960832  0.2960832  1.3211493  6.1513632 
> summary(b)

Call:
sltm(formula = time ~ 1, data = GBSG2)
Model:  continuous unconditional transformation model (transformed logistic distribution)
Coefficients (response transformation):
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time) 
-4.5307254  0.2960832  0.2960832  0.2960832  1.3211493  6.1513632 

AIC: 10709.87
Log-Likelihood: -5348.935 (df = 6)
> coef(b)
NULL
> vcov(b)
NULL
> predict(b)
NULL
> predict(b, q = 500:510, type = "distribution")
        1         2         3         4         5         6         7         8 
0.1935677 0.1942011 0.1948349 0.1954692 0.1961039 0.1967391 0.1973747 0.1980107 
        9        10        11 
0.1986471 0.1992840 0.1999213 
> 
> (b <- sltm(time | tgrade ~ 1, data = GBSG2))
Note: method with signature 'dsparseMatrix#dsparseMatrix' chosen for function 'kronecker',
 target signature 'dgTMatrix#dgCMatrix'.
 "TsparseMatrix#sparseMatrix" would also be valid
  Successful convergence.

Call:
sltm(formula = time | tgrade ~ 1, data = GBSG2)
Model: 
Coefficients:
  Bs1(time):tgradeI   Bs2(time):tgradeI   Bs3(time):tgradeI   Bs4(time):tgradeI 
         -5.0632465          -0.6604987          -0.2425022          -0.2425022 
  Bs5(time):tgradeI   Bs6(time):tgradeI  Bs1(time):tgradeII  Bs2(time):tgradeII 
          0.9545566           5.8786803          -4.7306384           0.2725994 
 Bs3(time):tgradeII  Bs4(time):tgradeII  Bs5(time):tgradeII  Bs6(time):tgradeII 
          0.2725994           0.2725994           1.2742938           5.8324562 
Bs1(time):tgradeIII Bs2(time):tgradeIII Bs3(time):tgradeIII Bs4(time):tgradeIII 
         -4.0496520           0.7615820           0.7615820           0.7615820 
Bs5(time):tgradeIII Bs6(time):tgradeIII 
          1.1797034           8.7945434 
> summary(b)

Call:
sltm(formula = time | tgrade ~ 1, data = GBSG2)
Model:  continuous stratified linear transformation model (transformed logistic distribution)
	continuous stratified proportional odds model
Coefficients (response transformation):
  Bs1(time):tgradeI   Bs2(time):tgradeI   Bs3(time):tgradeI   Bs4(time):tgradeI 
         -5.0632465          -0.6604987          -0.2425022          -0.2425022 
  Bs5(time):tgradeI   Bs6(time):tgradeI  Bs1(time):tgradeII  Bs2(time):tgradeII 
          0.9545566           5.8786803          -4.7306384           0.2725994 
 Bs3(time):tgradeII  Bs4(time):tgradeII  Bs5(time):tgradeII  Bs6(time):tgradeII 
          0.2725994           0.2725994           1.2742938           5.8324562 
Bs1(time):tgradeIII Bs2(time):tgradeIII Bs3(time):tgradeIII Bs4(time):tgradeIII 
         -4.0496520           0.7615820           0.7615820           0.7615820 
Bs5(time):tgradeIII Bs6(time):tgradeIII 
          1.1797034           8.7945434 

AIC: 10709.13
Log-Likelihood: -5336.567 (df = 18)
> coef(b)
NULL
> vcov(b)
NULL
> predict(b)
NULL
> predict(b, newdata = data.frame(tgrade = unique(GBSG2$tgrade)), q = 500:510, type = "distribution")
       
time         [,1]      [,2]      [,3]
    500 0.1803668 0.2772054 0.1059162
    501 0.1809881 0.2780119 0.1062979
    502 0.1816100 0.2788185 0.1066802
    503 0.1822325 0.2796250 0.1070631
    504 0.1828555 0.2804316 0.1074466
    505 0.1834790 0.2812381 0.1078308
    506 0.1841031 0.2820446 0.1082155
    507 0.1847278 0.2828510 0.1086009
    508 0.1853530 0.2836574 0.1089869
    509 0.1859787 0.2844638 0.1093735
    510 0.1866049 0.2852701 0.1097607
> 
> (cc <- sltm(Surv(time, cens) | tgrade ~ horTh + menostat + pnodes, data = GBSG2, method = "cloglog"))
  Successful convergence.

Call:
sltm(formula = Surv(time, cens) | tgrade ~ horTh + menostat + 
    pnodes, data = GBSG2, method = "cloglog")
Model: 
Coefficients:
  Bs1(time):tgradeI   Bs2(time):tgradeI   Bs3(time):tgradeI   Bs4(time):tgradeI 
         -9.6398482          -1.3275604          -1.3275604          -1.3275604 
  Bs5(time):tgradeI   Bs6(time):tgradeI  Bs1(time):tgradeII  Bs2(time):tgradeII 
         -1.3275604          -0.4611607          -5.3513891          -0.7322535 
 Bs3(time):tgradeII  Bs4(time):tgradeII  Bs5(time):tgradeII  Bs6(time):tgradeII 
         -0.7322535          -0.7322535          -0.4498750           0.1514630 
Bs1(time):tgradeIII Bs2(time):tgradeIII Bs3(time):tgradeIII Bs4(time):tgradeIII 
         -4.2325557          -0.4824990          -0.4824990          -0.4824990 
Bs5(time):tgradeIII Bs6(time):tgradeIII            horThyes        menostatPost 
         -0.4824990           0.3213415           0.3876009          -0.1395527 
             pnodes 
         -0.0565349 
> summary(cc)

Call:
sltm(formula = Surv(time, cens) | tgrade ~ horTh + menostat + 
    pnodes, data = GBSG2, method = "cloglog")
Model:  continuous stratified linear transformation model (transformed minimum extreme value distribution)
	continuous stratified proportional hazards model
Coefficients (response transformation):
  Bs1(time):tgradeI   Bs2(time):tgradeI   Bs3(time):tgradeI   Bs4(time):tgradeI 
         -9.6398482          -1.3275604          -1.3275604          -1.3275604 
  Bs5(time):tgradeI   Bs6(time):tgradeI  Bs1(time):tgradeII  Bs2(time):tgradeII 
         -1.3275604          -0.4611607          -5.3513891          -0.7322535 
 Bs3(time):tgradeII  Bs4(time):tgradeII  Bs5(time):tgradeII  Bs6(time):tgradeII 
         -0.7322535          -0.7322535          -0.4498750           0.1514630 
Bs1(time):tgradeIII Bs2(time):tgradeIII Bs3(time):tgradeIII Bs4(time):tgradeIII 
         -4.2325557          -0.4824990          -0.4824990          -0.4824990 
Bs5(time):tgradeIII Bs6(time):tgradeIII 
         -0.4824990           0.3213415 

Coefficients (linear predictor):
                   Estimate Std. Error z value Pr(>|z|)    
horThyes == 0      0.387601   0.128885   3.007  0.00264 ** 
menostatPost == 0 -0.139553   0.121507  -1.149  0.25075    
pnodes == 0       -0.056535   0.006815  -8.295  < 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

AIC: 5208.382
Log-Likelihood: -2583.191 (df = 21)
> coef(cc)
    horThyes menostatPost       pnodes 
   0.3876009   -0.1395527   -0.0565349 
> vcov(cc)
                  horThyes  menostatPost        pnodes
horThyes      0.0166113082 -3.360261e-03  3.503420e-05
menostatPost -0.0033602614  1.476389e-02 -1.325394e-05
pnodes        0.0000350342 -1.325394e-05  4.644830e-05
> predict(cc)
  [1]  0.309157370  0.147696049  0.260765858 -0.021908666  0.196087561
  [6]  1.356837717 -0.134978476  0.196087561  1.835599802  0.535296990
 [11]  0.260765858  0.260765858 -0.191513381  0.196087561 -0.078443571
 [16]  0.196087561  0.226139619 -0.191513381 -0.191513381  0.365692275
 [21]  0.196087561  0.252622465  0.196087561 -0.078443571  1.609460182
 [26]  0.113069810 -0.078443571  0.226139619 -0.191513381  0.113069810
 [31]  0.113069810  0.113069810 -0.191513381  0.252622465  0.282674524
 [36] -0.134978476  0.817971514  0.648366800  0.309157370  0.591831895
 [41]  0.535296990  2.148326385  0.196087561 -0.191513381 -0.191513381
 [46]  0.252622465  0.196087561  0.290817917  0.034626239  0.648366800
 [51] -0.191513381  0.196087561  0.196087561  0.008143393  0.395744334
 [56]  0.309157370  0.121213203 -0.021908666  0.226139619  0.260765858
 [61]  0.769580002  0.365692275  0.252622465  0.734953763 -0.134978476
 [66]  0.056534905  0.226139619  0.282674524  0.621883954  0.196087561
 [71]  0.339209429  0.056534905  0.091161144  0.761436609  0.904558478
 [76]  0.931041324  0.169604715  0.226139619  0.565349049  0.169604715
 [81]  0.339209429  0.056534905  0.339209429  0.478762085  0.091161144
 [86] -0.191513381  0.309157370  0.395744334  1.044111134  0.113069810
 [91]  0.373835668  0.252622465 -0.274531131  0.309157370  0.252622465
 [96]  0.056534905  0.931041324  0.196087561 -0.161461322  0.113069810
[101]  1.130698097  0.226139619  0.282674524  0.761436609  0.309157370
[106]  0.395744334  0.169604715  0.874506419  0.252622465  0.169604715
[111]  0.252622465  0.196087561  1.044111134  0.056534905  0.260765858
[116]  3.022832804  0.169604715 -0.078443571  0.395744334  0.056534905
[121]  0.196087561  0.056534905  0.056534905  0.056534905 -0.078443571
[126]  0.252622465  0.573492442  0.535296990 -0.217996227 -0.191513381
[131] -0.078443571  0.196087561  0.196087561  0.395744334 -0.331066036
[136] -0.078443571 -0.331066036  0.196087561  0.056534905  0.169604715
[141]  0.508814144  0.309157370  0.196087561 -0.274531131 -0.191513381
[146]  0.430370573  0.169604715 -0.191513381  0.395744334  0.309157370
[151]  0.339209429  0.252622465  0.034626239  0.422227180  0.034626239
[156]  0.282674524 -0.134978476  1.044111134  0.422227180  0.226139619
[161]  0.282674524  0.056534905  1.157180943  1.074163192  0.056534905
[166]  0.987576229  0.535296990  0.252622465  0.848023573  1.865651861
[171]  0.508814144  0.678418858  0.113069810  0.535296990  0.056534905
[176]  0.169604715 -0.191513381 -0.078443571  0.648366800 -0.191513381
[181] -0.134978476  0.056534905 -0.191513381 -0.134978476 -0.048391512
[186] -0.134978476  1.044111134 -0.078443571  0.252622465  0.478762085
[191] -0.134978476  0.565349049  0.339209429 -0.191513381  0.535296990
[196] -0.021908666  0.309157370  0.196087561  0.508814144  0.486905478
[201]  0.169604715  0.056534905 -0.134978476  0.252622465  0.056534905
[206]  0.056534905  0.704901704  0.113069810  0.309157370  0.817971514
[211]  0.252622465  0.056534905 -0.078443571  0.422227180  0.034626239
[216]  0.196087561  0.196087561  0.147696049  0.535296990 -0.191513381
[221] -0.191513381  0.196087561 -0.331066036  0.196087561  0.113069810
[226] -0.191513381  1.787208290  0.826114907  0.252622465  0.196087561
[231]  0.478762085  0.056534905 -0.078443571  0.260765858  0.196087561
[236] -0.191513381  0.817971514  0.452279239  0.034626239  0.252622465
[241] -0.134978476 -0.191513381 -0.078443571  0.478762085 -0.191513381
[246]  0.196087561  0.365692275  0.460422632  0.226139619 -0.104926417
[251] -0.134978476  0.226139619  0.056534905  0.204230954  0.113069810
[256]  0.226139619  0.147696049 -0.331066036 -0.134978476  0.226139619
[261]  0.034626239  0.204230954  0.113069810  0.486905478  0.056534905
[266]  0.196087561  0.365692275  0.113069810  0.339209429  0.056534905
[271]  0.056534905  0.034626239  0.034626239  0.113069810 -0.021908666
[276]  0.373835668 -0.021908666 -0.274531131  0.365692275  0.252622465
[281] -0.134978476 -0.161461322  0.252622465  0.430370573  0.113069810
[286] -0.161461322 -0.191513381  0.091161144  0.056534905  0.422227180
[291] -0.104926417  0.365692275 -0.191513381  0.196087561 -0.191513381
[296]  0.565349049  0.339209429  0.169604715  0.621883954  0.056534905
[301]  0.591831895 -0.134978476  0.478762085  0.317300763  0.791488668
[306]  0.252622465  0.056534905 -0.191513381  0.874506419  0.196087561
[311]  0.056534905  0.169604715  0.565349049  0.317300763  0.113069810
[316] -0.191513381  0.478762085  0.147696049 -0.274531131  0.196087561
[321]  0.395744334  0.339209429  0.008143393  0.113069810  0.113069810
[326]  0.395744334  0.365692275  0.056534905 -0.161461322 -0.217996227
[331]  0.422227180  0.091161144 -0.021908666  0.196087561  0.252622465
[336]  0.573492442  0.169604715 -0.331066036  0.252622465 -0.191513381
[341]  0.565349049  0.169604715  0.422227180  0.260765858  0.113069810
[346]  1.130698097  0.169604715  0.204230954  0.565349049  0.252622465
[351]  0.678418858  0.056534905  0.309157370  0.260765858  0.365692275
[356]  0.621883954 -0.191513381 -0.217996227  0.056534905  0.422227180
[361]  0.113069810  0.430370573  0.282674524  0.056534905 -0.191513381
[366]  0.309157370  0.422227180  0.204230954 -0.078443571 -0.191513381
[371]  0.591831895  0.309157370  0.056534905  0.056534905  0.113069810
[376]  0.309157370  0.365692275  0.169604715  0.056534905  0.282674524
[381]  0.113069810  1.213715848  0.169604715  1.100646038 -0.331066036
[386]  0.761436609 -0.191513381 -0.191513381  0.478762085 -0.331066036
[391] -0.048391512  0.478762085  0.591831895  0.056534905  0.113069810
[396]  0.395744334  0.113069810 -0.331066036  0.535296990  0.196087561
[401]  0.226139619  0.252622465  0.309157370 -0.161461322 -0.134978476
[406]  0.056534905  0.196087561  0.064678298  0.987576229  0.056534905
[411]  0.309157370  0.591831895  0.769580002 -0.078443571  0.064678298
[416] -0.331066036  0.395744334  0.008143393 -0.161461322  0.169604715
[421]  0.064678298  0.056534905  0.169604715  0.904558478  0.056534905
[426]  0.508814144  0.056534905  0.478762085  0.147696049 -0.134978476
[431] -0.021908666  0.422227180  0.339209429  0.113069810  0.056534905
[436] -0.078443571 -0.161461322  0.704901704  0.621883954  0.486905478
[441]  1.270250753  0.395744334  0.565349049  0.113069810  0.422227180
[446] -0.134978476  0.196087561  0.196087561  0.365692275 -0.191513381
[451]  0.252622465  0.365692275 -0.191513381 -0.078443571  0.373835668
[456]  0.113069810  0.056534905  0.226139619 -0.104926417 -0.191513381
[461]  0.147696049  1.591120729  0.196087561  0.591831895  1.496390373
[466] -0.021908666 -0.191513381 -0.191513381  0.686562251 -0.191513381
[471]  0.169604715  0.704901704  0.621883954  0.252622465 -0.217996227
[476]  0.430370573 -0.191513381 -0.048391512 -0.331066036  0.056534905
[481] -0.021908666  0.056534905 -0.134978476  0.373835668  0.196087561
[486]  0.252622465  0.034626239  0.056534905 -0.191513381  0.056534905
[491] -0.191513381 -0.078443571 -0.331066036  0.113069810 -0.078443571
[496] -0.191513381  0.591831895  0.252622465  0.113069810 -0.078443571
[501]  0.252622465 -0.134978476 -0.217996227 -0.134978476  0.565349049
[506]  0.904558478  0.252622465  0.486905478  0.365692275 -0.134978476
[511]  0.226139619  0.113069810  0.309157370  0.121213203  0.704901704
[516]  0.365692275  0.621883954  0.196087561  0.365692275  0.704901704
[521]  0.478762085  0.365692275 -0.134978476  0.260765858  0.056534905
[526] -0.191513381  0.056534905  0.196087561 -0.078443571  0.282674524
[531]  0.395744334 -0.021908666  0.452279239  0.478762085  0.169604715
[536]  0.147696049  0.452279239 -0.191513381 -0.191513381  0.252622465
[541]  0.113069810  0.113069810  0.056534905  0.373835668  0.196087561
[546]  0.282674524  0.113069810  0.147696049  0.113069810  0.769580002
[551]  0.874506419 -0.191513381 -0.191513381  0.252622465  0.591831895
[556]  1.074163192  0.365692275  0.535296990  0.282674524  0.034626239
[561]  0.056534905  0.656510192  0.452279239 -0.104926417  0.365692275
[566]  0.056534905  0.196087561 -0.191513381  0.395744334  0.422227180
[571] -0.274531131  0.113069810  0.056534905 -0.161461322  0.056534905
[576]  0.056534905  0.196087561  0.169604715  0.282674524  0.056534905
[581]  0.939184717  0.769580002  0.252622465  0.252622465  0.034626239
[586]  0.169604715  0.056534905 -0.078443571  0.478762085  1.052254527
[591]  0.678418858  0.226139619  0.169604715  0.196087561  0.196087561
[596]  0.478762085  0.147696049 -0.191513381 -0.021908666  0.734953763
[601]  0.621883954  0.196087561 -0.021908666  0.056534905  0.252622465
[606]  0.565349049  0.196087561  0.147696049  0.196087561  0.169604715
[611] -0.161461322  0.056534905  0.252622465  0.177748108 -0.274531131
[616]  0.196087561  0.430370573  0.395744334  0.056534905  0.713045097
[621]  0.874506419  0.113069810  0.169604715  0.252622465  0.565349049
[626]  0.874506419 -0.078443571  0.056534905 -0.021908666 -0.161461322
[631]  0.113069810  0.508814144  0.591831895  0.365692275 -0.134978476
[636]  0.317300763  0.113069810  0.056534905  0.113069810  0.056534905
[641] -0.021908666 -0.078443571 -0.134978476 -0.331066036  0.056534905
[646]  0.056534905 -0.134978476  0.196087561 -0.217996227  0.309157370
[651]  0.169604715  0.056534905  0.091161144 -0.048391512  0.113069810
[656] -0.331066036 -0.191513381  0.196087561  0.113069810  0.422227180
[661]  0.169604715 -0.217996227  0.196087561  0.196087561 -0.191513381
[666]  0.309157370  0.056534905  0.196087561  0.848023573 -0.191513381
[671]  0.430370573  0.309157370  0.113069810  0.252622465 -0.134978476
[676]  0.196087561  0.034626239  0.056534905  0.034626239  0.339209429
[681]  0.091161144  0.169604715  0.713045097  0.282674524  0.309157370
[686]  0.648366800
> predict(cc, newdata = expand.grid(horTh = sort(unique(GBSG2$horTh)), 
+                                   menostat = sort(unique(GBSG2$menostat))[1L],
+                                   pnodes = 30L, 
+                                   tgrade = sort(unique(GBSG2$tgrade))[2L]), 
+          q = 500:501, type = "trafo")
       
time          [,1]      [,2]
    500 -0.6647328 -1.052334
    501 -0.6609481 -1.048549
> 
> (d <- sltm(Surv(time, cens) ~ 1, data = GBSG2, method = "cloglog"))
  Successful convergence.

Call:
sltm(formula = Surv(time, cens) ~ 1, data = GBSG2, method = "cloglog")
Model: 
Coefficients:
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time) 
-4.6995126 -0.4965052 -0.4965052 -0.4965052 -0.3473768  0.2640242 
> summary(d)

Call:
sltm(formula = Surv(time, cens) ~ 1, data = GBSG2, method = "cloglog")
Model:  continuous unconditional transformation model (transformed minimum extreme value distribution)
Coefficients (response transformation):
 Bs1(time)  Bs2(time)  Bs3(time)  Bs4(time)  Bs5(time)  Bs6(time) 
-4.6995126 -0.4965052 -0.4965052 -0.4965052 -0.3473768  0.2640242 

AIC: 5271.788
Log-Likelihood: -2629.894 (df = 6)
> coef(d)
NULL
> vcov(d)
NULL
> predict(d)
NULL
> 
> cb <- confband(d, newdata = data.frame(1), calpha = univariate_calpha(), type = "surv")
> 
> layout(matrix(1:2, ncol = 2))
> plot(survfit(Surv(time, cens) ~ 1, data = GBSG2))
> plot(d, newdata = data.frame(1), type = "surv")
> lines(cb[,"q"], cb[,"lwr"])
> lines(cb[,"q"], cb[,"upr"])
> 
> proc.time()
   user  system elapsed 
  2.818   0.079   2.891 
