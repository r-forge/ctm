
R version 3.3.2 (2016-10-31) -- "Sincere Pumpkin Patch"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("trtf")
Loading required package: mlt
Loading required package: basefun
Loading required package: variables
Loading required package: partykit
Loading required package: grid

Attaching package: 'grid'

The following object is masked from 'package:variables':

    unit

Loading required package: libcoin
Loading required package: mvtnorm
> library("survival")
> data("GBSG2", package = "TH.data")
> set.seed(290875)
> 
> yvar <- numeric_var("y", support = c(100, 2000), bounds = c(0, Inf))
> By <- Bernstein_basis(yvar, order = 5, ui = "incre")
> m <- ctm(response = By, todistr = "MinExt")
> GBSG2$y <- with(GBSG2, Surv(time, cens))
> 
> tf <- traforest(m, formula = y ~ horTh + age + menostat + tsize + tgrade +
+     pnodes + progrec + estrec, data = GBSG2, 
+     control = ctree_control(splitstat = "quad", teststat = "quad",
+                     testtype = "Teststatistic", mincriterion = 1, minbucket = 50), 
+     ntree = 12, trace = FALSE, cores = 4)
> 
> predict(tf, newdata = GBSG2[1:3,], type = "weights")
        1  2 3
  [1,]  7  0 0
  [2,]  0  8 6
  [3,]  0  5 7
  [4,]  2  3 1
  [5,]  1  0 0
  [6,]  0  0 1
  [7,]  5  0 0
  [8,]  3  0 0
  [9,]  0  0 3
 [10,]  0  3 4
 [11,]  0  1 2
 [12,]  0  4 4
 [13,]  1  0 0
 [14,]  0  0 0
 [15,]  6  0 0
 [16,]  1  0 0
 [17,]  1  1 2
 [18,]  1  0 0
 [19,]  1  0 0
 [20,]  6  3 3
 [21,]  2  0 0
 [22,]  6  0 0
 [23,]  2  0 0
 [24,]  4  0 0
 [25,]  0  0 1
 [26,]  2  0 0
 [27,]  5  0 0
 [28,]  0  1 4
 [29,]  0  0 0
 [30,]  0  0 0
 [31,]  0  0 0
 [32,]  0  0 0
 [33,]  1  0 0
 [34,]  6  0 0
 [35,]  0  8 6
 [36,]  2  0 0
 [37,]  0  1 1
 [38,]  0  5 6
 [39,]  2  0 0
 [40,]  0  8 6
 [41,]  0  6 5
 [42,]  0  3 4
 [43,]  1  0 0
 [44,]  0  0 0
 [45,]  1  0 0
 [46,]  7  0 0
 [47,]  2  0 0
 [48,]  0  0 1
 [49,]  0  8 6
 [50,]  0  3 6
 [51,]  2  0 0
 [52,]  0  0 0
 [53,]  3  0 0
 [54,]  0  4 4
 [55,]  0  5 4
 [56,]  5  0 0
 [57,]  0  3 2
 [58,]  1  2 2
 [59,]  0  0 0
 [60,]  0  5 4
 [61,]  0  0 0
 [62,]  4  3 4
 [63,]  2  0 0
 [64,]  0  5 4
 [65,]  2  0 0
 [66,]  0  0 0
 [67,]  0  0 3
 [68,]  0  7 8
 [69,]  0  0 1
 [70,]  1  0 0
 [71,]  0  6 3
 [72,]  0  0 0
 [73,]  0  1 3
 [74,]  0  0 2
 [75,]  0  2 3
 [76,]  0  1 2
 [77,]  0  0 0
 [78,]  0  1 1
 [79,]  0  0 1
 [80,]  9  0 0
 [81,]  0  3 4
 [82,]  0  0 0
 [83,]  0  2 1
 [84,]  0  2 2
 [85,]  0  3 3
 [86,]  1  0 0
 [87,]  8  0 0
 [88,]  0  2 2
 [89,]  0  0 4
 [90,]  0  0 0
 [91,]  0  0 4
 [92,]  4  0 0
 [93,]  1  0 0
 [94,]  5  0 0
 [95,]  6  0 0
 [96,]  0  0 0
 [97,]  0  0 3
 [98,]  2  0 0
 [99,]  1  2 1
[100,]  2  0 0
[101,]  0  0 4
[102,]  2  0 0
[103,]  0  4 3
[104,]  0  6 6
[105,]  4  0 0
[106,]  0  3 4
[107,]  2  0 0
[108,]  0  3 3
[109,]  3  0 0
[110,]  9  0 0
[111,]  7  0 0
[112,]  1  0 0
[113,]  0  0 1
[114,]  0  0 0
[115,]  0  5 4
[116,]  0  3 4
[117,]  2  0 0
[118,]  5  0 0
[119,]  0  3 4
[120,]  0  0 0
[121,]  0  0 0
[122,]  0  0 0
[123,]  1  0 0
[124,]  0  0 0
[125,]  3  0 0
[126,]  8  0 0
[127,]  0  0 1
[128,]  0  7 6
[129,]  5  0 0
[130,]  1  0 0
[131,]  3  0 0
[132,]  2  0 0
[133,]  1  0 0
[134,]  0  7 6
[135,]  0  0 0
[136,]  2  0 0
[137,]  0  0 0
[138,]  3  0 0
[139,]  0  0 0
[140,]  0  0 0
[141,]  0  1 4
[142,]  7  0 0
[143,]  3  0 0
[144,]  1  0 0
[145,]  0  0 0
[146,]  0  0 0
[147,]  4  0 0
[148,]  1  0 0
[149,]  0  6 3
[150,]  4  0 0
[151,]  0  4 5
[152,]  1  0 0
[153,]  1  3 0
[154,]  0  2 1
[155,]  0  8 7
[156,]  0  4 6
[157,]  3  0 0
[158,]  0  0 0
[159,]  0  3 2
[160,]  0  3 3
[161,]  0  5 5
[162,]  1  0 0
[163,]  0  3 6
[164,]  0  2 2
[165,]  0  0 0
[166,]  0  4 4
[167,]  0  3 2
[168,]  6  0 0
[169,]  0  3 4
[170,]  0  1 2
[171,]  0  3 4
[172,]  0  3 6
[173,]  1  0 0
[174,]  0  8 6
[175,]  1  0 0
[176,]  0  0 0
[177,]  0  0 0
[178,]  1  0 0
[179,]  0  0 1
[180,]  1  0 0
[181,]  4  0 0
[182,]  0  0 0
[183,]  1  0 0
[184,]  2  0 0
[185,]  0  8 5
[186,]  4  0 0
[187,]  0  0 0
[188,]  4  0 0
[189,]  7  0 0
[190,]  0  4 3
[191,]  3  0 0
[192,]  0  2 3
[193,]  0  1 1
[194,]  1  0 0
[195,]  0  5 5
[196,]  3  1 1
[197,]  3  0 0
[198,]  3  0 0
[199,]  0  3 6
[200,]  0  2 4
[201,]  1  0 0
[202,]  0  0 0
[203,]  5  0 0
[204,]  6  0 0
[205,]  0  0 0
[206,]  0  0 0
[207,]  0  0 1
[208,]  1  0 0
[209,]  4  0 0
[210,]  0  0 1
[211,]  6  0 0
[212,]  0  0 0
[213,]  6  0 0
[214,]  0  5 4
[215,]  0  0 0
[216,]  2  0 0
[217,]  1  0 0
[218,]  0  2 5
[219,]  0  3 4
[220,]  1  0 0
[221,]  0  0 0
[222,]  1  0 0
[223,]  0  0 0
[224,]  3  0 0
[225,]  1  0 0
[226,]  1  0 0
[227,]  0  0 1
[228,]  0  0 4
[229,]  4  0 0
[230,]  1  0 0
[231,]  0  4 4
[232,]  0  0 0
[233,]  5  0 0
[234,]  0  3 3
[235,]  1  0 0
[236,]  0  0 0
[237,]  0  4 7
[238,]  0  5 6
[239,]  0  3 3
[240,]  6  0 0
[241,]  3  0 0
[242,]  0  0 0
[243,]  6  0 0
[244,]  0  4 3
[245,]  0  0 0
[246,]  0  0 0
[247,]  2  1 1
[248,]  0  0 4
[249,]  0  1 2
[250,]  0  1 3
[251,]  4  0 0
[252,]  1  2 1
[253,]  0  0 0
[254,]  0  2 4
[255,]  1  0 0
[256,]  2  1 2
[257,]  0  2 2
[258,]  1  0 0
[259,]  2  0 0
[260,]  1  0 0
[261,]  0  3 2
[262,]  0  0 3
[263,]  0  0 0
[264,]  0  0 4
[265,]  0  0 0
[266,]  0  0 0
[267,]  1  0 0
[268,]  2  0 0
[269,]  0  1 0
[270,]  0  0 0
[271,]  0  0 0
[272,]  0  4 3
[273,]  0  2 4
[274,]  2  0 0
[275,]  1  0 1
[276,]  0  4 5
[277,]  1  0 0
[278,]  1  0 0
[279,]  2  2 3
[280,]  9  0 0
[281,]  4  0 0
[282,]  1  1 0
[283,]  5  0 0
[284,]  0  0 1
[285,]  6  0 0
[286,]  2  3 1
[287,]  1  0 0
[288,]  1  4 2
[289,]  1  0 0
[290,]  0  3 1
[291,]  0  7 4
[292,]  3  2 1
[293,]  1  0 0
[294,]  2  0 0
[295,]  1  0 0
[296,]  0  0 0
[297,]  0  3 4
[298,]  3  0 0
[299,]  0  3 3
[300,]  0  0 0
[301,]  0  2 2
[302,]  2  0 0
[303,]  0  5 6
[304,]  0  4 4
[305,]  0  5 4
[306,]  6  0 0
[307,]  0  0 0
[308,]  1  0 0
[309,]  0  0 0
[310,]  2  0 0
[311,]  0  0 0
[312,]  0  0 0
[313,]  0  2 5
[314,]  0  2 6
[315,]  2  0 0
[316,]  0  0 0
[317,]  0  9 6
[318,]  0  2 1
[319,]  1  0 0
[320,]  2  0 0
[321,]  0  2 1
[322,]  0  2 1
[323,]  0  9 7
[324,]  1  0 0
[325,]  5  0 0
[326,]  0  3 6
[327,]  2  0 0
[328,]  0  0 0
[329,]  0  1 3
[330,]  2  0 0
[331,]  0  3 4
[332,]  0  2 2
[333,]  3  3 3
[334,]  2  0 0
[335,]  8  0 0
[336,]  0  0 1
[337,]  0  0 0
[338,]  0  0 0
[339,]  7  0 0
[340,]  1  0 0
[341,]  0  5 5
[342,]  1  0 0
[343,]  0  2 3
[344,]  0  6 5
[345,]  2  0 0
[346,]  0  2 3
[347,]  0  0 0
[348,]  0  6 5
[349,]  0  1 3
[350,]  5  0 0
[351,]  0  0 3
[352,]  0  0 0
[353,]  4  0 0
[354,]  0  2 3
[355,]  5  3 1
[356,]  0  5 4
[357,]  0  0 0
[358,]  2  0 0
[359,]  1  0 0
[360,]  1  2 2
[361,]  0  0 0
[362,]  0  5 4
[363,]  0  7 5
[364,]  0  0 0
[365,]  0  0 0
[366,]  7  0 0
[367,]  0  6 5
[368,]  0  6 8
[369,]  7  0 0
[370,]  0  0 0
[371,]  0  9 7
[372,] 10  0 0
[373,]  0  0 0
[374,]  0  0 0
[375,]  0  0 0
[376,]  7  0 0
[377,]  3  0 1
[378,]  1  0 0
[379,]  0  0 0
[380,]  0  3 4
[381,]  1  0 0
[382,]  0  2 5
[383,]  2  0 0
[384,]  0  0 2
[385,]  0  0 0
[386,]  0  6 4
[387,]  0  0 0
[388,]  1  0 0
[389,]  0  3 5
[390,]  0  0 0
[391,]  0  6 5
[392,]  0  7 6
[393,]  0  7 6
[394,]  0  0 0
[395,]  0  0 0
[396,]  0  5 7
[397,]  1  0 0
[398,]  0  0 0
[399,]  0  2 3
[400,]  0  0 0
[401,]  0  0 0
[402,]  2  0 0
[403,]  7  0 0
[404,]  0  1 1
[405,]  6  0 0
[406,]  0  0 0
[407,]  1  0 0
[408,]  0  7 7
[409,]  0  5 6
[410,]  0  0 0
[411,]  2  0 0
[412,]  0  1 2
[413,]  0  4 5
[414,]  4  0 0
[415,]  0  6 4
[416,]  0  0 0
[417,]  0  4 3
[418,]  0  6 7
[419,]  2  3 1
[420,]  3  0 0
[421,]  0  1 2
[422,]  0  0 0
[423,]  0  0 0
[424,]  0  0 0
[425,]  0  0 0
[426,]  0  5 4
[427,]  1  0 0
[428,]  0  7 3
[429,]  0  7 6
[430,]  4  0 0
[431,]  1  0 0
[432,]  0  2 1
[433,]  0  5 3
[434,]  2  0 0
[435,]  0  0 0
[436,]  5  0 0
[437,]  0  0 2
[438,]  0  0 1
[439,]  0  0 2
[440,]  0  1 3
[441,]  0  0 1
[442,]  0  3 2
[443,]  0  0 1
[444,]  2  0 0
[445,]  0  8 6
[446,]  1  0 0
[447,]  3  0 0
[448,]  1  0 0
[449,]  1  1 1
[450,]  2  0 0
[451,]  1  0 0
[452,]  0  1 1
[453,]  1  0 0
[454,]  4  0 0
[455,]  0  0 1
[456,]  1  0 0
[457,]  0  0 0
[458,]  0  1 1
[459,]  0  4 3
[460,]  1  0 0
[461,]  0  7 4
[462,]  0  2 1
[463,]  2  0 0
[464,]  0  3 3
[465,]  0  0 0
[466,]  1  0 3
[467,]  0  0 0
[468,]  0  0 0
[469,]  0  0 3
[470,]  0  0 0
[471,]  0  0 0
[472,]  0  0 1
[473,]  0  0 0
[474,]  6  0 0
[475,]  0  0 0
[476,]  0  3 4
[477,]  0  0 0
[478,]  0  5 2
[479,]  1  0 0
[480,]  0  0 0
[481,]  1  0 2
[482,]  0  0 0
[483,]  1  0 0
[484,]  0  1 3
[485,]  3  0 0
[486,]  4  0 0
[487,]  0  4 4
[488,]  0  0 0
[489,]  0  0 0
[490,]  0  0 0
[491,]  1  0 0
[492,]  4  0 0
[493,]  0  0 0
[494,]  0  0 0
[495,]  3  0 0
[496,]  0  0 0
[497,]  0  2 3
[498,]  6  0 0
[499,]  3  0 0
[500,]  3  0 0
[501,]  6  0 0
[502,]  1  0 0
[503,]  1  0 0
[504,]  2  0 0
[505,]  0  3 4
[506,]  0  1 5
[507,]  4  0 0
[508,]  0  2 6
[509,]  5  2 2
[510,]  4  0 0
[511,]  1  2 2
[512,]  2  0 0
[513,]  4  0 0
[514,]  0  3 4
[515,]  0  0 1
[516,]  3  5 2
[517,]  0  0 1
[518,]  1  0 0
[519,]  1  3 2
[520,]  0  0 2
[521,]  0  6 5
[522,]  5  2 1
[523,]  4  0 0
[524,]  0  3 4
[525,]  0  0 0
[526,]  1  0 0
[527,]  0  0 0
[528,]  2  0 0
[529,]  7  0 0
[530,]  0  2 4
[531,]  0  4 5
[532,]  3  3 1
[533,]  0  1 1
[534,]  1  9 5
[535,]  0  0 0
[536,]  0  4 5
[537,]  0  2 4
[538,]  1  0 0
[539,]  0  0 0
[540,]  6  0 0
[541,]  2  0 0
[542,]  0  0 0
[543,]  0  0 0
[544,]  0  3 4
[545,]  1  0 0
[546,]  1  3 2
[547,]  1  0 0
[548,]  0  4 4
[549,]  2  0 0
[550,]  0  0 1
[551,]  0  1 2
[552,]  1  0 0
[553,]  1  0 0
[554,]  5  0 0
[555,]  0  1 3
[556,]  0  1 2
[557,]  3  0 0
[558,]  0 10 7
[559,]  0  8 6
[560,]  0  1 0
[561,]  0  0 0
[562,]  0  0 1
[563,]  0  2 3
[564,]  1  8 4
[565,]  3  1 1
[566,]  0  0 0
[567,]  2  0 0
[568,]  1  0 0
[569,]  0  6 5
[570,]  1  7 5
[571,]  0  0 0
[572,]  0  0 0
[573,]  0  0 0
[574,]  0  0 2
[575,]  0  0 0
[576,]  0  0 0
[577,]  1  0 0
[578,]  0  0 0
[579,]  0  3 4
[580,]  0  0 0
[581,]  0  0 2
[582,]  0  0 1
[583,]  1  0 0
[584,]  5  0 0
[585,]  0  3 3
[586,]  0  0 0
[587,]  0  0 0
[588,]  1  0 0
[589,]  0  2 1
[590,]  0  0 3
[591,]  0  0 1
[592,]  3  3 2
[593,]  0  0 0
[594,]  2  0 0
[595,]  0  0 0
[596,]  0  8 5
[597,]  0  7 5
[598,]  1  0 0
[599,]  3  3 1
[600,]  0  0 2
[601,]  0  0 2
[602,]  1  0 0
[603,]  3  2 2
[604,]  0  0 0
[605,]  5  0 0
[606,]  0  4 5
[607,]  0  0 0
[608,]  0  3 2
[609,]  2  0 0
[610,]  0  0 0
[611,]  1  0 0
[612,]  1  0 0
[613,]  4  0 0
[614,]  0  0 3
[615,]  1  0 0
[616,]  2  0 0
[617,]  0  0 1
[618,]  0  3 3
[619,]  0  0 0
[620,]  0  1 3
[621,]  0  2 2
[622,]  0  0 0
[623,]  1  0 0
[624,]  0  0 0
[625,]  0  5 7
[626,]  0  0 4
[627,]  4  0 0
[628,]  1  0 0
[629,]  4  3 1
[630,]  0  1 1
[631,]  0  0 0
[632,]  0  2 4
[633,]  0  1 2
[634,]  1  0 2
[635,]  1  0 0
[636,]  0  4 4
[637,]  2  0 0
[638,]  1  0 0
[639,]  3  0 0
[640,]  0  0 0
[641,]  3  1 3
[642,]  3  0 0
[643,]  3  0 0
[644,]  0  0 0
[645,]  0  0 0
[646,]  0  0 0
[647,]  5  0 0
[648,]  4  0 0
[649,]  0  0 0
[650,]  7  0 0
[651,]  1  0 0
[652,]  1  0 0
[653,]  0  1 2
[654,]  0  1 2
[655,]  3  0 0
[656,]  0  0 0
[657,]  1  0 0
[658,]  3  0 0
[659,]  0  0 0
[660,]  0  8 7
[661,]  5  0 0
[662,]  1  0 0
[663,]  0  0 0
[664,]  0  0 0
[665,]  0  0 0
[666,]  7  0 0
[667,]  0  0 0
[668,]  1  0 0
[669,]  0  0 4
[670,]  0  0 0
[671,]  0  3 4
[672,]  7  0 0
[673,]  3  0 0
[674,]  1  0 0
[675,]  6  0 0
[676,]  2  0 0
[677,]  0  8 8
[678,]  0  0 0
[679,]  0  6 4
[680,]  0  3 3
[681,]  0  0 1
[682,]  2  0 0
[683,]  0  0 1
[684,]  1  3 3
[685,]  5  0 0
[686,]  0  7 6
> predict(tf, newdata = GBSG2[1:3,], type = "node")
[[1]]
[1]  8 10 10

[[2]]
[1]  9 10 11

[[3]]
[1]  9 10 10

[[4]]
[1]  6 10 10

[[5]]
[1]  7 12 12

[[6]]
[1]  8 12 11

[[7]]
[1]  9 12 12

[[8]]
[1]  9 13 13

[[9]]
[1]  8 11 12

[[10]]
[1]  7 11 11

[[11]]
[1]  6 10  9

[[12]]
[1] 5 9 9

> (cf <- predict(tf, newdata = GBSG2[1:3,], type = "coef"))
$`1`
    Bs1(y)     Bs2(y)     Bs3(y)     Bs4(y)     Bs5(y)     Bs6(y) 
-6.9894330 -0.9152268 -0.9152267 -0.9152268 -0.7968274 -0.4218356 

$`2`
    Bs1(y)     Bs2(y)     Bs3(y)     Bs4(y)     Bs5(y)     Bs6(y) 
-4.4799704 -0.7949663 -0.7949663 -0.5320015 -0.5320016 -0.1033975 

$`3`
    Bs1(y)     Bs2(y)     Bs3(y)     Bs4(y)     Bs5(y)     Bs6(y) 
-4.1550255 -0.5216429 -0.5216429 -0.2337506 -0.2337506  0.1229909 

> 
> logLik(tf, newdata = GBSG2[1:3,])
'log Lik.' -23.59123 (df=NA)
> 
> sapply(1:length(tf$nodes), function(i) logLik(gettree(tf, i)))
 [1] -2558.351 -2557.946 -2558.034 -2552.855 -2555.608 -2548.336 -2560.171
 [8] -2552.493 -2556.481 -2553.211 -2555.435 -2547.945
> 
> varimp(tf)
    horTh       age  menostat     tsize    tgrade    pnodes   progrec    estrec 
 2.209613 14.809560  0.000000  2.293811  5.115821 98.748126 22.748875  3.094768 
   (time)    (cens)         y 
 0.000000  0.000000  0.000000 
> 
> mod <- mlt(m, data = GBSG2)
> logLik(mod)
'log Lik.' -2618.714 (df=6)
> 
> logLik(mod, newdata = GBSG2[1:3,])
'log Lik.' -24.62877 (df=NULL)
> 
> layout(matrix(1:2, nr = 1))
> coef(mod) <- cf[[1]]
> plot(mod, newdata = data.frame(1), type = "survivor")
> coef(mod) <- cf[[2]]
> plot(mod, newdata = data.frame(1), type = "survivor", add = TRUE)
> coef(mod) <- cf[[3]]
> plot(mod, newdata = data.frame(1), type = "survivor", add = TRUE)
> 
> simulate(tf, newdata = GBSG2[1:3,], nsim = 3)
[[1]]
[1] (2000, Inf]      542.133501473453 1869.59415973492

[[2]]
[1] 466.067578874183 492.862091785556 488.624986802357

[[3]]
[1] 575.213053468727 488.128048202027 1459.93762058781

> 
> cmod <- coxph(Surv(time, cens) ~ horTh + age + menostat + tsize + tgrade +
+     pnodes + progrec + estrec, data = GBSG2)
> 
> plot(survfit(cmod, newdata = GBSG2[1:3,]))
> 
> proc.time()
   user  system elapsed 
 39.764   0.360  22.271 
