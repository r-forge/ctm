
> pkgs <- c("tram", "TH.data", "multcomp", "survival", 
+     "Stat2Data", "tramME")

> pkgs <- sapply(pkgs, require, character.only = TRUE)
Loading required package: tram
Loading required package: mlt
Loading required package: basefun
Loading required package: variables
Loading required package: mvtnorm
Loading required package: TH.data
Loading required package: survival
Loading required package: MASS

Attaching package: ‘TH.data’

The following object is masked from ‘package:MASS’:

    geyser

Loading required package: multcomp
Loading required package: Stat2Data
Loading required package: tramME

> year <- substr(packageDescription("tram")$Date, 1, 
+     4)

> version <- packageDescription("tram")$Version

> if (any(!pkgs)) {
+     cat(paste("Package(s)", paste(names(pkgs)[!pkgs], collapse = ", "), 
+         "not available, stop processing.", "\\end{doc ..." ... [TRUNCATED] 

> if (!interactive() && .Platform$OS.type != "unix") {
+     cat(paste("Vignette only compiled under Unix alikes.", "\\end{document}\n"))
+     knitr: .... [TRUNCATED] 

> knitr::opts_chunk$set(echo = TRUE, results = "markup", 
+     error = FALSE, warning = FALSE, message = FALSE, tidy = FALSE, 
+     cache = FALSE, s .... [TRUNCATED] 

> knitr::render_sweave()

> knitr::set_header(highlight = "")

> options(prompt = "R> ", continue = "+  ", useFancyQuotes = FALSE)

> options(width = 75)

> frmt1 <- function(x, digits = 1) {
+     if (!is.numeric(x)) 
+         return(x)
+     formatC(round(x, digits = digits), digits = digits, format = .... [TRUNCATED] 

> frmt3 <- function(x) frmt1(x, digits = 3)

> frmtci <- function(x, digits = 3) {
+     if (!is.numeric(x)) 
+         return(x)
+     if (length(x) != 2) 
+         stop("not a confidence inter ..." ... [TRUNCATED] 

> set.seed(221224)

> immun <- structure(list(y = c(21.7, 23.9, 22.7, 23.4, 
+     26.8, 24.8, 23.4, 25.1, 24.1, 23.3, 25.4, 25.1, 23.8, 23.1, 
+     24, 24.2, 27.4, 23.3 .... [TRUNCATED] 

> m0 <- Lm(y ~ w, data = immun)

> coef(m0)
      w100 
0.04816709 

> sqrt(vcov(m0))
          w100
w100 0.2236392

> sqrt(2/nrow(immun) * (coef(m0)^2/4 + 2))
     w100 
0.2236392 

> confint(m0)
          2.5 %    97.5 %
w100 -0.3901577 0.4864919

> m1 <- BoxCox(x ~ 1, data = immun)

> m <- Mmlt(m0, m1, formula = ~1, data = immun)

> (cf1 <- coef(m)["y.w100"])
      y.w100 
-0.001668928 

> sqrt(diag(vcov(m))["y.w100"])
   y.w100 
0.1747482 

> lambda <- c(unclass(coef(m, type = "Lambdapar")))

> sqrt(2/nrow(immun) * ((1 + lambda^2) * cf1^2 + 8)/(4 * 
+     (1 + lambda^2)))
   y.w100 
0.1745792 

> confint(m)["y.w100", ]
     2.5 %     97.5 % 
-0.3441692  0.3408313 

> coef(m, type = "Corr")
, , 1

          y         x
y 1.0000000 0.6248541
x 0.6248541 1.0000000


> Omega <- as.array(coef(m, type = "Lambda"))[, , 1]

> 1 - Omega[nrow(Omega), ncol(Omega)]^(-2)
[1] 0.3904427

> mad <- BoxCoxME(y ~ w + s(x), data = immun)

> plot(smooth_terms(mad))

> plot(mad)

> m0 <- BoxCox(y ~ w, data = immun)

> m <- Mmlt(m0, m1, formula = ~1, data = immun)

> Omega <- as.array(coef(m, type = "Lambda"))[, , 1]

> 1 - Omega[nrow(Omega), ncol(Omega)]^(-2)
[1] 0.5121276

> (cf1 <- coef(m)["y.w100"])
   y.w100 
0.0298195 

> confint(m)["y.w100", ]
     2.5 %     97.5 % 
-0.2792883  0.3389273 

> pnorm(cf1/sqrt(2))
   y.w100 
0.5084113 

> load(system.file("rda", "Primary_endpoint_data.rda", 
+     package = "TH.data"))

> rt <- table(CAOsurv$randarm)

> CAOsurv$ypT0ypN0 <- factor(CAOsurv$path_stad == "ypT0ypN0")

> mg_w <- glm(ypT0ypN0 ~ randarm, data = CAOsurv, family = binomial())

> exp(coef(mg_w)["randarm5-FU + Oxaliplatin"])
randarm5-FU + Oxaliplatin 
                 1.421517 

> exp(confint(glht(mg_w), calpha = univariate_calpha())$confint[2, 
+     -1])
     lwr      upr 
1.036590 1.949382 

> mpCR <- Polr(ypT0ypN0 ~ randarm, data = CAOsurv, na.action = na.pass, 
+     method = "logistic")

> exp(coef(mpCR)["randarm5-FU + Oxaliplatin"])
randarm5-FU + Oxaliplatin 
                 1.421518 

> exp(confint(glht(mpCR, coef. = function(...) coef(..., 
+     fixed = FALSE)), calpha = univariate_calpha())$confint)
                          Estimate      lwr      upr
randarm5-FU + Oxaliplatin 1.421518 1.036591 1.949384
attr(,"conf.level")
[1] 0.95
attr(,"calpha")
[1] 1.959964

> mage <- BoxCox(age ~ 1, data = CAOsurv)

> msex <- Polr(geschlecht ~ 1, data = CAOsurv, method = "probit")

> CAOsurv$ecog_o <- as.ordered(CAOsurv$ecog_b)

> mecog <- Polr(ecog_o ~ 1, data = CAOsurv, na.action = na.pass, 
+     method = "probit")

> mentf <- Polr(bentf ~ 1, data = CAOsurv, na.action = na.pass, 
+     method = "probit")

> mT <- Polr(strat_t ~ 1, data = CAOsurv, method = "probit")

> mN <- Polr(strat_n ~ 1, data = CAOsurv, method = "probit")

> m <- Mmlt(mage, msex, mecog, mentf, mT, mN, mpCR, 
+     data = CAOsurv, args = list(type = "ghalton", M = 50))

> prm <- "ypT0ypN0.randarm5-FU + Oxaliplatin"

> exp(coef(m)[prm])
ypT0ypN0.randarm5-FU + Oxaliplatin 
                          1.401745 

> ci <- confint(glht(m, coef. = function(...) coef(..., 
+     fixed = FALSE)), calpha = univariate_calpha())$confint

> exp(ci[prm, -1])
     lwr      upr 
1.022535 1.921585 

> mr <- as.array(coef(m, type = "Cor"))["ypT0ypN0", 
+     , 1]

> i <- which.max(abs(mr[-length(mr)]))

> (ni <- names(mr)[i])
[1] "ecog_o"

> (mr <- mr[i])
    ecog_o 
-0.1520201 

> Omega <- as.array(coef(m, type = "Lambda"))[, , 1]

> 1 - Omega[nrow(Omega), ncol(Omega)]^(-2)
[1] 0.03038266

> sqrt(vcov(mpCR))
                          randarm5-FU + Oxaliplatin
randarm5-FU + Oxaliplatin                 0.1611192

> sqrt(vcov(m)[prm, prm])
[1] 0.1609381

> data("FruitFlies", package = "Stat2Data")

> flies <- FruitFlies

> flies <- flies[flies$Treatment %in% c("8 virgin", 
+     "8 pregnant"), ]

> flies$Treatment <- flies$Treatment[, drop = TRUE]

> flies$Longevity <- as.double(flies$Longevity)

> flies$survival <- Surv(flies$Longevity)

> coxph_w <- Coxph(survival ~ Treatment, data = flies)

> coef(coxph_w)
Treatment8 virgin 
         2.156399 

> confint(coxph_w)
                     2.5 %   97.5 %
Treatment8 virgin 1.342623 2.970175

> xmod <- BoxCox(Thorax ~ 1, data = flies)

> m <- Mmlt(xmod, coxph_w, data = flies, formula = ~1)

> (cf1 <- coef(m)["survival.Treatment8 virgin"])
survival.Treatment8 virgin 
                  2.048255 

> (ci1 <- confint(m)["survival.Treatment8 virgin", ])
   2.5 %   97.5 % 
1.430691 2.665819 

> Omega <- as.array(coef(m, type = "Lambda"))[, , 1]

> 1 - Omega[nrow(Omega), ncol(Omega)]^(-2)
[1] 0.6714107

> q <- 0:100

> cols <- c("grey20", "grey70")

> plot(q, log(-log(1 - ecdf(subset(flies, Treatment == 
+     "8 pregnant")$survival[, 1])(q))), main = "", xlab = "Time", 
+     type = "S", lwd = 1, .... [TRUNCATED] 

> lines(q, log(-log(1 - ecdf(subset(flies, Treatment == 
+     "8 virgin")$survival[, 1])(q))), type = "S", lty = 2, lwd = 1)

> legend("bottomright", lty = c(1, 2), legend = levels(flies$Treatment), 
+     bty = "n")

> nd <- expand.grid(survival = q, Treatment = sort(unique(flies$Treatment)))

> nd$h <- predict(as.mlt(coxph_w), newdata = nd, type = "trafo")

> fm <- nd$Treatment == "8 virgin"

> lines(nd$survival[fm], nd$h[fm], lty = 2)

> fm <- nd$Treatment == "8 pregnant"

> lines(nd$survival[fm], nd$h[fm], lty = 1)

> m <- CoxphME(survival ~ s(Thorax, k = 5), data = flies, 
+     subset = Treatment == levels(Treatment)[1])

> plot(smooth_terms(m))

> m <- CoxphME(survival ~ s(Thorax, k = 5), data = flies, 
+     subset = Treatment == levels(Treatment)[2])

> plot(smooth_terms(m), add = TRUE, lty = 2)

> if (file.exists("packages.bib")) file.remove("packages.bib")

> toLower <- function(text) {
+     parts <- strsplit(unname(text), split = ":")[[1]]
+     w1 <- paste0(parts[1], ":")
+     p2 <- strsplit(parts[2], .... [TRUNCATED] 

> sentence_style <- FALSE

> x <- citation()[[1]]

> b <- toBibtex(x)

> b <- gsub("R:", paste0("\\\\proglang{R}:"), b)

> b <- gsub("R ", paste0("\\\\proglang{R} "), b)

> if (sentence_style) b["title"] <- toLower(b["title"])

> b[1] <- "@Manual{R,"

> cat(b, sep = "\n", file = "packages.bib", append = TRUE)

> pkgv <- function(pkg) packageVersion(pkg)

> pkgbib <- function(pkg) {
+     x <- citation(package = pkg, auto = TRUE)[[1]]
+     b <- toBibtex(x)
+     b <- gsub("packaging by", "", b)
+     b .... [TRUNCATED] 

> pkg <- function(pkg) paste("\\pkg{", pkg, "} \\citep[version~", 
+     pkgv(pkg), ",][]{pkg:", pkg, "}", sep = "")

> pkgs <- c("tram")

> sapply(pkgs, pkgbib)
$tram
NULL


> out <- sapply(pkgs, pkg)

 *** Run successfully completed ***
> proc.time()
   user  system elapsed 
 39.406   0.142  39.553 
